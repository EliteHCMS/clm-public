import{Q as O}from"./QPage.8b35320d.js";import{m as V,l as B,bN as h,bL as w,r as k,w as E,_ as M,A as i,B as f,D as s,ab as m,an as p,bi as n,d as a,cw as u,d5 as U,cx as L,ao as x,bK as W,cy as z,bO as F,cz as Q,a7 as l,bM as H}from"./index.226bbe9e.js";import{q as A,b as S,F as K,u as R,H as C}from"./quickbase.aae604ff.js";import{u as I}from"./use-quasar.e37fb258.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.61ba8b06.js";import"./index.7dbe61ef.js";import"./localForage.2f4a21a3.js";import"./api.1ce17484.js";import"./i18n.df17a73c.js";const q=V("QRStore",{state:()=>({qr:null}),getters:{getQR:e=>e.qr},actions:{async fetchQRData(e){const r=[{7:{value:"QR Code"},9:{value:e}}],{data:t}=await A.fetchFromStructureApp({fields:r});t?this.qr=t:this.qr={}}}}),P=B({setup(){const e=I(),{setEvent:r}=S(),{getQR:t}=h(q()),{employeeData:o,addMatrixToEmployee:c}=K(),{getUser:d}=R(),_=R(),v=w(),b=k(!1),D=k(!1),g=k(""),T=k(""),Y=async()=>{r(null),_.logout().then(()=>{v.replace({name:"login"})})};async function j(){const y={12:{value:o[3]},6:{value:t.value[17]},13:{value:t.value[16]},17:{value:t.value[14]},23:{value:t.value[3]},10:{value:`${d[35]} ${d[37]}`}};t.value[17]==="date"?Object.assign(y,{8:{value:g.value}}):t.value[17]==="checkbox"||t.value[20]?Object.assign(y,{9:{value:b.value}}):Object.assign(y,{7:{value:T.value}});try{const{data:$}=await A.upsertRecordsXML({to:"bsi3t4bcz",data:[y],fieldsToReturn:[11],formatObject:11});$&&(c({data:{key:t.value[16],value:$[0][11]}}),D.value=!0,setTimeout(function(){Y()},5e3))}catch{e.notify({type:"negative",message:"There was a problem submitting"})}}E(b,(y,$)=>{y?g.value=C.formatDate(Date.now(),"YYYY-MM-DD"):g.value=""});function N(){o[t.value[16]]&&(D.value=!0,setTimeout(function(){Y()},5e3))}return N(),{getQR:t,confirmation:b,submitted:D,submitAttendanceRecord:j,employeeData:o,completionDate:g,entryString:T,date:C}}}),X={class:"row justify-center q-mt-md"},G={class:"col-12 col-md-4 q-px-sm"},J={class:"text-primary text-h6 q-mb-md"},Z={class:"text-white text-body1"},ee={class:"text-dark text-body2"},te={key:0,class:"q-pt-md"},se=s("div",{class:"text-white text-body1"},"Congratulations",-1),ae={class:"text-dark text-body2"},oe=s("div",{class:"text-dark text-body2"},"You are done. You may close this screen.",-1),ne=s("div",{class:"text-primary text-body1"},"THANK YOU!",-1);function le(e,r,t,o,c,d){return i(),f("div",null,[s("div",X,[s("div",G,[s("div",J,"Welcome, "+m(e.employeeData[20])+"!",1),e.submitted?(i(),p(Q,{key:1,class:"text-center"},{default:n(()=>[a(u,{class:"bg-info"},{default:n(()=>[se]),_:1}),a(u,null,{default:n(()=>[s("div",ae,"You have successfully submitted your attendance record for "+m(e.getQR[19])+" on "+m(e.date.formatDate(e.employeeData[e.getQR[16]][1].$d,"MM/DD/YYYY"))+".",1),oe]),_:1}),a(u,null,{default:n(()=>[ne]),_:1})]),_:1})):(i(),p(Q,{key:0,class:"text-center"},{default:n(()=>[a(u,{class:"bg-info"},{default:n(()=>[s("div",Z,m(e.getQR[19]),1)]),_:1}),a(u,null,{default:n(()=>[s("div",ee,m(e.getQR[11]),1)]),_:1}),e.getQR[20]?(i(),p(u,{key:0},{default:n(()=>[s("div",null,[a(U,{modelValue:e.confirmation,"onUpdate:modelValue":r[0]||(r[0]=_=>e.confirmation=_),label:e.getQR[21]},null,8,["modelValue","label"])]),e.confirmation?(i(),f("div",te,[a(L,{type:"date",modelValue:e.completionDate,"onUpdate:modelValue":r[1]||(r[1]=_=>e.completionDate=_),label:"Date Completed","stack-label":""},null,8,["modelValue"])])):x("",!0)]),_:1})):x("",!0),a(W),a(z,{align:"right"},{default:n(()=>[e.getQR[20]?(i(),p(F,{key:0,color:"primary",label:"Submit",disable:e.getQR[20]&&(!e.confirmation||e.completionDate===""),onClick:e.submitAttendanceRecord},null,8,["disable","onClick"])):x("",!0)]),_:1})]),_:1}))])])])}var ie=M(P,[["render",le]]);const re={class:"row justify-center q-mt-md"},ce={class:"col-12 col-md-4 q-px-sm"},de={class:"text-primary text-h6 q-mb-md"},ue=s("div",{class:"text-white text-body1"},"No Training Available",-1),me=s("div",{class:"text-dark text-body2"},"No Training Available. You may close this screen.",-1),fe=s("div",{class:"text-primary text-body1"},"Thank You!",-1),_e={__name:"qrNoTraining",setup(e){const r=w(),t=R(),{setEvent:o}=S(),{fullName:c}=h(t),d=async()=>{o(null),t.logout().then(()=>{r.replace({name:"login"})})};return setTimeout(function(){d()},5e3),(_,v)=>(i(),f("div",null,[s("div",re,[s("div",ce,[s("div",de,"Welcome, "+m(l(c))+"!",1),a(Q,{class:"text-center"},{default:n(()=>[a(u,{class:"bg-info"},{default:n(()=>[ue]),_:1}),a(u,null,{default:n(()=>[me]),_:1}),a(u,null,{default:n(()=>[fe]),_:1})]),_:1})])])]))}},ye={class:"row justify-center q-mt-md"},ve={class:"col-12 col-md-4 q-px-sm"},pe={class:"text-primary text-h6 q-mb-md"},he={class:"text-white text-body1"},be={key:0,class:"text-dark text-body2"},ge={key:1,class:"text-dark text-body2"},$e={key:2,class:"text-dark text-body2"},ke=s("div",{class:"text-primary text-body1"},"Thank You!",-1),xe={__name:"qrTrainingEnded",setup(e){const r=w(),t=R(),{setEvent:o}=S(),{getQR:c}=h(q()),{fullName:d}=h(t),_=async()=>{o(null),t.logout().then(()=>{r.replace({name:"login"})})};return setTimeout(function(){_()},5e3),(v,b)=>(i(),f("div",null,[s("div",ye,[s("div",ve,[s("div",pe,"Welcome, "+m(l(d))+"!",1),a(Q,{class:"text-center"},{default:n(()=>[a(u,{class:"bg-info"},{default:n(()=>[s("div",he,m(l(c)[19]),1)]),_:1}),a(u,null,{default:n(()=>[l(c)[10].isSameOrBefore(v.$dayjs(),"day")?l(c)[9].isSameOrAfter(v.$dayjs(),"day")?(i(),f("div",$e,"Training no longer Available. You may close this screen.")):(i(),f("div",ge,"Training has already ended on "+m(l(c)[9].format("L"))+". You may close this screen.",1)):(i(),f("div",be,"Training has not started, will begin on "+m(l(c)[10].format("L"))+".",1))]),_:1}),a(u,null,{default:n(()=>[ke]),_:1})]),_:1})])])]))}},Qe={key:0},Re={key:1},qe={key:2},Ve={__name:"index",setup(e){const r=H(),{fetchQRData:t}=q(),{getQR:o}=h(q());async function c(){const d=r.query.qr;await t(d)}return c(),(d,_)=>(i(),p(O,{style:{"max-width":"100vw"}},{default:n(()=>[l(o)&&l(o)[3]&&l(o)[10].isSameOrBefore(d.$dayjs(),"day")&&l(o)[9].isSameOrAfter(d.$dayjs(),"day")&&l(o)[8]===!1?(i(),f("div",Qe,[a(ie)])):l(o)&&!l(o)[3]?(i(),f("div",Re,[a(_e)])):l(o)&&l(o)[3]?(i(),f("div",qe,[a(xe)])):x("",!0)]),_:1}))}};export{Ve as default};
