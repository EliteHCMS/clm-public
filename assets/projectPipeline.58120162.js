import{l as U,c as P,_ as V,y as p,ap as h,bq as n,d as o,cU as w,B as r,aw as q,ab as u,bR as z,cT as L,r as O,v as E,b4 as J,z as _,bP as Q,bV as T,aq as I,F as S,b3 as N,D as F}from"./index.a03c16e1.js";import{Q as R}from"./QInnerLoading.d8b14ee8.js";import{a as B,Q as W}from"./QTable.c2e23d38.js";import{Q as M}from"./QTr.3f9bffc4.js";import{Q as A}from"./QTd.a2e291df.js";import{u as G}from"./use-quasar.581262ce.js";import{e as H}from"./export-file.dc78ba05.js";import{dayjs as $}from"./dayjs.8e614a0b.js";import{b as K,u as X}from"./app.8e730c48.js";const Z=U({name:"Pipeline Summary",components:{},props:{pipeline:Array},setup(t,y){const m=P(()=>t.pipeline.filter(l=>l.type==="In Process"||l.type==="Dispatch")),i=P(()=>t.pipeline.filter(l=>l.type==="Deployed"&&l[20]==="In Process")),b=P(()=>m.value.length+i.value.length);return{props:t,inProcess:m,deployed:i,total:b}}}),ee=r("div",{class:"text-body1 text-primary"},"Summary",-1),te={class:"text-body2"},se=r("span",{class:"q-mr-md"},"In Process:",-1),ae=r("span",null,null,-1),re={class:"text-body2"},ne=r("span",{class:"q-mr-md"},"Deployed:",-1),oe={class:"text-body2"},le=r("span",{class:"q-mr-md"},"Total:",-1);function ie(t,y,m,i,b,g){return p(),h(L,null,{default:n(()=>[o(w,{class:"q-pb-xs"},{default:n(()=>[ee]),_:1}),o(w,{class:"text-right q-pt-xs"},{default:n(()=>[r("div",te,[se,q(u(t.inProcess.length),1),ae]),r("div",re,[ne,r("span",null,u(t.deployed.length),1)]),o(z,{color:"primary",class:"q-my-sm"}),r("div",oe,[le,r("span",null,u(t.total),1)])]),_:1})]),_:1})}var de=V(Z,[["render",ie]]);const{openWindow:fe}=K(),pe=U({name:"Pipeline Table",emits:["refreshData"],components:{PipelineSummary:de},props:{rows:Array,selected:Array,filter:String},setup(t,y){const m=G(),{capitalize:i}=E,b=O(!1),{getUserType:g}=X(),l=P(()=>m.screen.gt.sm?[{name:1,label:"Name",align:"left",field:e=>s(e.employee),format:e=>`${e}`,sortable:!0},{name:8,label:"Phone #",align:"left",field:e=>e.employee[25],format:e=>`${e}`,sortable:!1},{name:7,label:"Status",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Offer Date",align:"left",field:e=>Y(e),format:e=>`${$(e).format("MM/DD/YYYY")}`,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>k(e),format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>C(e),format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Expected Date",align:"left",field:e=>v(e),format:e=>`${e?$(e).format("MM/DD/YYYY"):"TBD"}`,sortable:!0}]:[{name:1,label:"Name",align:"left",field:e=>s(e.employee),format:e=>`${e}`,sortable:!0},{name:8,label:"Phone #",align:"left",field:e=>e.employee[25],format:e=>`${e}`,sortable:!1},{name:7,label:"Status",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Offer Date",align:"left",field:e=>Y(e),format:e=>`${$(e).format("MM/DD/YYYY")}`,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>k(e),format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>C(e),format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Expected Date",align:"left",field:e=>v(e),format:e=>`${e?$(e).format("MM/DD/YYYY"):"TBD"}`,sortable:!0}]),s=e=>{const c=e[20]!==""?i(e[20].toLowerCase().trim()):"",D=e[22]!==""?i(e[22].toLowerCase().trim()):"",a=e[21]!==""?` ${i(e[21].toLowerCase().trim())}`:"",f=e[23]!==""?` ${i(e[23])}`:"";return`${D}${f}, ${c}${a}`};function d(e){if(e.type==="In Process")return"In Process";if(e.type==="Dispatch")return"In Process";if(e.type==="Deployed")return"Deployed"}function Y(e){if(e.type==="In Process")return e[197].$d;if(e.type==="Dispatch")return e[165].$d;if(e.type==="Deployed")return e[144].$d}function k(e){if(e.type==="In Process")return e[106];if(e.type==="Dispatch")return e[45];if(e.type==="Deployed")return e[45]}function C(e){if(e.type==="In Process")return e[44];if(e.type==="Dispatch")return e[63];if(e.type==="Deployed")return e[85]}function v(e){if(e.type==="In Process")return null;if(e.type==="Dispatch")return null;if(e.type==="Deployed")return e[33].$d}const x=(e,c,D)=>{let a=c!==void 0?c(e,D):e;return a=a==null?"":String(a),a=a.split('"').join('""'),`"${a}"`};function j(){const e=t.rows&&t.rows.value?t.rows.value:t.rows,c=[l.value.map(a=>x(a.label))].concat(e.map(a=>l.value.map(f=>x(typeof f.field=="function"?f.field(a):a[f.field===void 0?f.name:f.field],f.format,a)).join(","))).join(`\r
`);H(`${$().format("MM.DD.YYYY")} Project-Pipeline-Export.csv`,c,"text/csv")!==!0&&m.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return{columns:l,props:t,loading:b,exportPipeline:j,viewProfile:e=>{fe(null,{url:`https://elitehcms.quickbase.com/db/bs7qsu6wh?a=dbpage&pageID=6&ee=${e[16]}`,name:"View Profile"})},getUserType:g}}}),me={class:"q-px-sm"},ce={class:"row"},ue={class:"col-12 col-md-10 q-px-xs"},ye={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function be(t,y,m,i,b,g){const l=J("pipeline-summary");return p(),_("div",me,[r("div",ce,[r("div",ue,[o(W,{dense:"",columns:t.columns,rows:t.props.rows,"row-key":s=>s[3],class:"q-pa-sm",filter:t.filter?t.filter.trim():null,pagination:{rowsPerPage:t.$q.screen.gt.sm?25:100},separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":"There is no one in the pipeline",loading:t.loading,grid:t.$q.screen.lt.md},{"no-data":n(({message:s})=>[r("div",ye,[o(Q,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),r("span",null,u(s),1)])]),"top-right":n(()=>[o(T,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:y[0]||(y[0]=s=>t.$emit("refreshData"))}),o(T,{dense:t.$q.screen.lt.md,color:"primary",label:"Download",onClick:t.exportPipeline,disable:t.props.rows.length<1},null,8,["dense","onClick","disable"])]),loading:n(()=>[o(R,{showing:"",color:"primary"})]),header:n(s=>[o(M,{class:"bg-dark text-white",props:s},{default:n(()=>[t.getUserType==="QuickBase User"?(p(),h(B,{key:0,"auto-width":""})):I("",!0),(p(!0),_(S,null,N(s.cols,d=>(p(),h(B,{key:d.name,props:s},{default:n(()=>[q(u(d.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(s=>[o(M,{props:s},{default:n(()=>[t.getUserType==="QuickBase User"?(p(),h(A,{key:0,"auto-width":""},{default:n(()=>[o(Q,{class:"cursor-pointer",size:t.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:d=>t.viewProfile(s.row),name:s.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024)):I("",!0),(p(!0),_(S,null,N(s.cols,d=>(p(),h(A,{key:d.name,props:s},{default:n(()=>[q(u(d.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["columns","rows","row-key","filter","pagination","loading","grid"])]),r("div",{class:F(t.$q.screen.lt.md?"col-12 q-px-xs q-mt-sm order-first":"col-2 q-px-xs")},[o(l,{pipeline:t.props.rows},null,8,["pipeline"])],2)])])}var ve=V(pe,[["render",be]]);export{ve as P};
