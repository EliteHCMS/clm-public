import{Q as oe,a as _e,b as se}from"./QTabPanels.8debf809.js";import{Q as xe}from"./QTabs.809dd373.js";import{Q as Ne}from"./QToolbar.cdfb5494.js";import{Q as ke}from"./QPage.076a4a22.js";import{Q as T}from"./QSpace.df74a9a4.js";import{bS as re,bU as B,r as u,w as P,c as ne,o as ie,aP as O,y as z,z as fe,d as t,bq as n,cU as de,B as m,D as E,cT as ce,bP as S,a7 as U,ab as Q,cV as ue,ap as le,bV as A,aw as L,aq as me,v as pe}from"./index.ffe008a3.js";import{Q as W}from"./QTd.8827818e.js";import{Q as F}from"./QTooltip.aa54978d.js";import{Q as be}from"./QInnerLoading.56779734.js";import{Q as ge}from"./QTable.38b8ded1.js";import{u as ve}from"./use-quasar.8f886427.js";import{e as ye}from"./export-file.dc78ba05.js";import{dayjs as w}from"./dayjs.90447d16.js";import{c as we,u as he,i as $e}from"./app.5c870bdd.js";import"./QSelect.ae55bb14.js";import{_ as De}from"./officeMultiSelector.5a2739e9.js";import"./use-panel.71d52368.js";import"./touch.3df10340.js";import"./selection.67688afd.js";import"./QResizeObserver.825a34be.js";import"./rtl.b51694b1.js";import"./position-engine.a8f2d15a.js";import"./QList.ec7dea95.js";import"./QMarkupTable.790f93ea.js";import"./use-fullscreen.6e4ff1be.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.24be37ee.js";import"./index.04bc0a32.js";import"./i18n.ee1ec30d.js";import"./QChip.3ca5e7ec.js";import"./QMenu.1f533564.js";const Ye={class:"row items-center"},Ie={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},Re={class:"col-12 col-md-5 q-px-sm"},Ce={__name:"pending",setup(te){const _=re(),x=ve(),N=we(),k=he(),{getSelectedProject:b,getSelectedMultiOffice:d}=B(N),{userOffices:G}=B(k),{capitalize:q}=pe,H=u(b.value?b.value[3]:null),Y=u(),h=u([]),$=u(""),I=u(""),g=u(!1),f=u({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});P(b,()=>{H.value=b.value?b.value[3]:null}),P(I,()=>{C()}),P(d,()=>{C()});const J=ne(()=>d.value.length<=4?"col-md-4":d.value.length<=6?"col-md-5":d.value.length<=8?"col-md-6":d.value.length<=10?"col-md-7":d.value.length<=12?"col-md-8":d.value.length<=14?"col-md-9":d.value.length<=16?"col-md-10":"col-md-4"),R=u([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${M(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0}]),V=u([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${M(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0}]),M=e=>{const s=e.split(" ");let a="";return s.forEach((l,c)=>{a+=c>0?` ${q(l.toLowerCase())}`:q(l.toLowerCase())}),a},j=({page:e,pageSize:s,descending:a,filter:l,sortBy:c})=>{try{let i="";const v=l&&l!=="";v&&(i=l.trim());const o=[];d.value.length>0?d.value.forEach(y=>{o.push(y[8])}):G.value("read").forEach(y=>{o.push(y[8])});const r={$or:[{fullName:{$containsi:`${i}`}},{classification:{$containsi:`${i}`}},{jobNumber:{$containsi:`${i}`}},{workdayId:{$containsi:`${i}`}},{phoneNumber:{$containsi:`${i}`}},{payrollId:{$containsi:`${i}`}}]},p={$and:[...v?[r]:[],{status:{$in:["Pending","Reviewed"]}},...o.length>0?[{officeRID:{$in:o}}]:[],...I.value?[{effectiveDate:{$eq:I.value}}]:[]]};return $e.getReleases({pagination:{page:e,pageSize:s},sort:`${c||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:p}).then(y=>{const{data:ee,meta:ae}=y;return g.value=!1,{data:ee,meta:ae}})}catch(i){console.log(i),g.value=!1}},K=async e=>{const{page:s,rowsPerPage:a,sortBy:l,descending:c}=e.pagination,i=e.filter,v=a===0?f.value.rowsNumber:a;g.value=!0;const o=await j({page:s,sortBy:l,descending:c,pageSize:v,filter:i});if(g.value=!1,o){const{data:r,meta:p}=o;h.value.splice(0,h.value.length,...r),f.value.page=p.pagination.page,f.value.sortBy=l,f.value.descending=c,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsNumber=p.pagination.total}};ie(()=>{O(()=>{Y.value.requestServerInteraction()})});const C=()=>{O(()=>{Y.value.requestServerInteraction()})};function D(e,s,a){let l=s!==void 0?s(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const X=async()=>{const{page:e,rowsNumber:s,sortBy:a,descending:l}=f.value,c=await j({page:e,sortBy:a,descending:l,pageSize:s,filter:$.value});let i=[R.value.map(o=>D(o.label))].concat(h.value.map(o=>R.value.map(r=>D(typeof r.field=="function"?r.field(o):o[r.field===void 0?r.name:r.field],r.format,o)).join(","))).join(`\r
`);c&&c.data&&(i=[V.value.map(o=>D(o.label))].concat(c.data.map(o=>V.value.map(r=>D(typeof r.field=="function"?r.field(o):o[r.field===void 0?r.name:r.field],r.format,o)).join(","))).join(`\r
`)),ye(`${w().format("MM.DD.YYYY")} Releases-Export.csv`,i,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function Z(e){_.push({name:"view-release",params:{release:e.id}})}return(e,s)=>(z(),fe("div",null,[t(ce,{flat:""},{default:n(()=>[t(de,null,{default:n(()=>[m("div",Ye,[t(T),m("div",{class:E(["col-12 q-px-sm",[J.value]])},[t(De)],2)])]),_:1})]),_:1}),m("div",null,[t(ge,{title:"Pending Releases","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:Y,columns:R.value,rows:h.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:f.value,"onUpdate:pagination":s[2]||(s[2]=a=>f.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"",separator:"horizontal",color:"accent","binary-state-sort":"",filter:$.value,onRequest:K},{"body-cell-action":n(a=>[t(W,{props:a},{default:n(()=>[t(S,{class:"cursor-pointer",size:U(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>Z(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":n(a=>[t(W,{props:a},{default:n(()=>[m("span",null,Q(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":n(({message:a})=>[m("div",Ie,[t(S,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,Q(a),1)])]),top:n(()=>[m("div",Re,[t(ue,{dense:"",modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=a=>$.value=a),label:"Search...",clearable:""},{prepend:n(()=>[t(S,{name:"search"})]),_:1},8,["modelValue"])]),t(T),m("div",{class:E(["text-dark text-caption text-italic",U(x).screen.lt.md?"offset-xs-5":""])},"(Total: "+Q(f.value.rowsNumber)+" releases)",3),f.value.rowsNumber<=1e3?(z(),le(A,{key:0,flat:"",round:"",color:"primary",icon:"download",disable:f.value.rowsNumber<1,onClick:X},{default:n(()=>[t(F,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:n(()=>[L(" Download ")]),_:1})]),_:1},8,["disable"])):me("",!0),t(A,{flat:"",round:"",color:"primary",icon:"refresh",onClick:s[1]||(s[1]=a=>C(!0)),loading:g.value},{default:n(()=>[t(F,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:n(()=>[L(" Refresh ")]),_:1})]),_:1},8,["loading"])]),loading:n(()=>[t(be,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},Pe={class:"row items-center"},Se={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},Qe={class:"col-12 col-md-5 q-px-sm"},qe={__name:"releases",setup(te){const _=re(),x=ve(),N=we(),k=he(),{getSelectedProject:b,getSelectedMultiOffice:d}=B(N),{userOffices:G}=B(k),{capitalize:q}=pe,H=u(b.value?b.value[3]:null),Y=u(),h=u([]),$=u(""),I=u(""),g=u(!1),f=u({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});P(b,()=>{H.value=b.value?b.value[3]:null}),P(I,()=>{C()}),P(d,()=>{C()});const J=ne(()=>d.value.length<=4?"col-md-4":d.value.length<=6?"col-md-5":d.value.length<=8?"col-md-6":d.value.length<=10?"col-md-7":d.value.length<=12?"col-md-8":d.value.length<=14?"col-md-9":d.value.length<=16?"col-md-10":"col-md-4"),R=u([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${M(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0}]),V=u([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${M(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${w(e).format("MM/DD/YYYY")}`,sortable:!0}]),M=e=>{const s=e.split(" ");let a="";return s.forEach((l,c)=>{a+=c>0?` ${q(l.toLowerCase())}`:q(l.toLowerCase())}),a},j=({page:e,pageSize:s,descending:a,filter:l,sortBy:c})=>{try{let i="";const v=l&&l!=="";v&&(i=l.trim());const o=[];d.value.length>0?d.value.forEach(y=>{o.push(y[8])}):G.value("read").forEach(y=>{o.push(y[8])});const r={$or:[{fullName:{$containsi:`${i}`}},{classification:{$containsi:`${i}`}},{jobNumber:{$containsi:`${i}`}},{workdayId:{$containsi:`${i}`}},{phoneNumber:{$containsi:`${i}`}},{payrollId:{$containsi:`${i}`}}]},p={$and:[...v?[r]:[],...o.length>0?[{officeRID:{$in:o}}]:[],...I.value?[{effectiveDate:{$eq:I.value}}]:[]]};return $e.getReleases({pagination:{page:e,pageSize:s},sort:`${c||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:p}).then(y=>{const{data:ee,meta:ae}=y;return g.value=!1,{data:ee,meta:ae}})}catch(i){console.log(i),g.value=!1}},K=async e=>{const{page:s,rowsPerPage:a,sortBy:l,descending:c}=e.pagination,i=e.filter,v=a===0?f.value.rowsNumber:a;g.value=!0;const o=await j({page:s,sortBy:l,descending:c,pageSize:v,filter:i});if(g.value=!1,o){const{data:r,meta:p}=o;h.value.splice(0,h.value.length,...r),f.value.page=p.pagination.page,f.value.sortBy=l,f.value.descending=c,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsNumber=p.pagination.total}};ie(()=>{O(()=>{Y.value.requestServerInteraction()})});const C=()=>{O(()=>{Y.value.requestServerInteraction()})};function D(e,s,a){let l=s!==void 0?s(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const X=async()=>{const{page:e,rowsNumber:s,sortBy:a,descending:l}=f.value,c=await j({page:e,sortBy:a,descending:l,pageSize:s,filter:$.value});let i=[R.value.map(o=>D(o.label))].concat(h.value.map(o=>R.value.map(r=>D(typeof r.field=="function"?r.field(o):o[r.field===void 0?r.name:r.field],r.format,o)).join(","))).join(`\r
`);c&&c.data&&(i=[V.value.map(o=>D(o.label))].concat(c.data.map(o=>V.value.map(r=>D(typeof r.field=="function"?r.field(o):o[r.field===void 0?r.name:r.field],r.format,o)).join(","))).join(`\r
`)),ye(`${w().format("MM.DD.YYYY")} Releases-Export.csv`,i,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function Z(e){_.push({name:"view-release",params:{release:e.id}})}return(e,s)=>(z(),fe("div",null,[t(ce,{flat:""},{default:n(()=>[t(de,null,{default:n(()=>[m("div",Pe,[t(T),m("div",{class:E(["col-12 q-px-sm",[J.value]])},[t(De)],2)])]),_:1})]),_:1}),m("div",null,[t(ge,{title:"Releases","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:Y,columns:R.value,rows:h.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:f.value,"onUpdate:pagination":s[2]||(s[2]=a=>f.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"",separator:"horizontal",color:"accent","binary-state-sort":"",filter:$.value,onRequest:K},{"body-cell-action":n(a=>[t(W,{props:a},{default:n(()=>[t(S,{class:"cursor-pointer",size:U(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>Z(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":n(a=>[t(W,{props:a},{default:n(()=>[m("span",null,Q(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":n(({message:a})=>[m("div",Se,[t(S,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,Q(a),1)])]),top:n(()=>[m("div",Qe,[t(ue,{dense:"",modelValue:$.value,"onUpdate:modelValue":s[0]||(s[0]=a=>$.value=a),label:"Search...",clearable:""},{prepend:n(()=>[t(S,{name:"search"})]),_:1},8,["modelValue"])]),t(T),m("div",{class:E(["text-dark text-caption text-italic",U(x).screen.lt.md?"offset-xs-5":""])},"(Total: "+Q(f.value.rowsNumber)+" releases)",3),f.value.rowsNumber<=1e3?(z(),le(A,{key:0,flat:"",round:"",color:"primary",icon:"download",disable:f.value.rowsNumber<1,onClick:X},{default:n(()=>[t(F,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:n(()=>[L(" Download ")]),_:1})]),_:1},8,["disable"])):me("",!0),t(A,{flat:"",round:"",color:"primary",icon:"refresh",onClick:s[1]||(s[1]=a=>C(!0)),loading:g.value},{default:n(()=>[t(F,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:n(()=>[L(" Refresh ")]),_:1})]),_:1},8,["loading"])]),loading:n(()=>[t(be,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},Ve={class:"q-pa-md"},ma={__name:"index",setup(te){const _=u(0);return(x,N)=>(z(),le(ke,{style:{"max-width":"100vw"}},{default:n(()=>[m("div",Ve,[t(Ne,{class:"bg-info text-white shadow-2 rounded-borders"},{default:n(()=>[t(xe,{modelValue:_.value,"onUpdate:modelValue":N[0]||(N[0]=k=>_.value=k),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:n(()=>[t(oe,{name:0,label:"Pending Releases"}),t(oe,{name:1,label:"Releases"})]),_:1},8,["modelValue"])]),_:1}),t(_e,{modelValue:_.value,"onUpdate:modelValue":N[1]||(N[1]=k=>_.value=k),animated:""},{default:n(()=>[t(se,{name:0},{default:n(()=>[t(Ce)]),_:1}),t(se,{name:1},{default:n(()=>[t(qe)]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{ma as default};
