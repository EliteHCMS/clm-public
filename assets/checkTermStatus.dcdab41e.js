import{i as l,q as d,u as f}from"./app.b339b179.js";import{s as p}from"./syncEmployeeWithWorkday.0144a020.js";import{dayjs as a}from"./dayjs.5512aee7.js";import"./dataStore.1dac7d59.js";import"./dataStore.876ce2d7.js";import{u as y}from"./useQuerySaver.d29ff9ee.js";const g=async({release:t})=>{const e={employeeId:t[50],options:{includeTransactionLogData:!0,includeManagementChainData:!1,includeRelatedPersons:!1,transactionDateRangeData:{updatedFrom:`${a().subtract(6,"month").format("YYYY-MM-DD")}`,updatedThrough:`${a().format("YYYY-MM-DD")}`},filter:{page:1,count:1}}},{data:r}=await l.getWorkers(e),o=r[0];if(!o)return t;p({id:t[25],worker:o});const{employmentData:s,jobHistory:n}=o||{employmentData:null,jobHistory:null};if(!s||!n)return t;let i=[];if(t.jobHistory=n,n.forEach(c=>{if(Object.keys(c).includes("terminateEmployee")){const{terminateEmployee:m}=c;i.push(m)}}),i.length>0){const c=i.find(u=>a(u.logEntryMoment)>a(t[1].$d));i=i.sort((u,m)=>a(u.logEffectiveMoment)>a(m.logEffectiveMoment)?-1:1),c&&(t.lastTerm=c,t.terminated=!s.workerStatus.active,t.termEntryDate=a(c.logEntryMoment))}else return t;return t.terminations=i,t.workday=o,t},E=async({array:t})=>{const e=[];return t.forEach(async s=>{const n=g({release:s});e.push(n)}),(await Promise.allSettled(e)).map(s=>s.value)},Y=async({release:t})=>{const e=t[93],r=t[102]&&t[t[102]]?t[t[102]]:null,o=r?y({status:e,id:r}):null;if(o){const{data:s}=await d.fetchFromHiringApp({fields:[o]}),n=s;return n?{reassigned:n[1].$d>t[1].$d,timestamp:n[1].$d}:{reassigned:!1,timestamp:null}}else return{reassigned:!1,timestamp:null}},$=async({release:t,disposition:e,ts:r,updatedBy:o})=>{f();const s=o;s&&(s.access&&delete s.access,s.permissions&&delete s.permissions);const{data:n}=await d.upsertRecordsXML({to:"bp3ga39ut",data:[{3:{value:t[3]},42:{value:"Complete"},43:{value:e},44:{value:t[44].$d||r},73:{value:"Cancelled"},75:{value:t[75]?JSON.stringify(t[75]):s?JSON.stringify(s):""},77:{value:t[77].$d||a()}}],fieldsToReturn:[80],formatObject:80});return n[0][80]};export{g as a,Y as b,E as c,$ as u};
