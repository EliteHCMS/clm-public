import{a4 as re,bU as E,y as q,ap as I,au as ie,b3 as ne,bq as i,A as de,aa as ce,aG as ue,a7 as e,B as s,D as pe,ab as b,E as me,r as M,c as W,w as A,d as r,cT as fe,bN as ve,cU as H,aq as R,b as m,z as K,cV as J,cW as be,bV as X}from"./index.b35eeed3.js";import{a as S}from"./QSelect.2ba35ed2.js";import{Q as _e}from"./QSpinnerGears.6a7643ab.js";import{Q as he}from"./QForm.6c8993a8.js";import{Q as we}from"./QPage.6f4063c4.js";import{a as ye,u as f}from"./vee-validate.esm.0c700e69.js";import{a as g,c as v}from"./array.164cfe36.js";import{u as Se,c as Y,b as Ve}from"./app.31ce29fc.js";import{u as ge}from"./use-quasar.6afddd70.js";import{s as qe}from"./states.03e3d448.js";import"./QChip.86c715a9.js";import"./QMenu.fc0510b6.js";import"./position-engine.301e00c6.js";import"./selection.423f1a2d.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.c324749c.js";import"./localForage.504e0e11.js";import"./index.04bc0a32.js";import"./i18n.a721d321.js";const Ce={__name:"officeSelectorAlt",props:{can:{type:String,default:"read"},twilio:{type:Boolean,default:!1},styleSelection:{type:Boolean,default:!1}},setup(L){const P=L,{can:_,twilio:C,styleSelection:k}=re(P),B=Se(),x=Y(),{userOffices:h}=E(B),{setSelectedOffice:V}=x,{getSelectedOffice:w}=E(x);w.value||(h.value(_.value).length>1&&h.value(_.value).forEach(n=>{n[15]===!0&&V(n,!0)}),w.value||V(h.value(_.value)[0],!0));const d=n=>{V(n,!0)};return(n,T)=>(q(),I(S,me({"model-value":e(w),options:e(h)(e(_),e(C))},n.$attrs,{"onUpdate:modelValue":d,label:e(w)?"Office":"Select Office","option-label":"11","option-value":"8",clearable:!1,dense:""}),ie({_:2},[ne(n.$slots,(Q,U)=>({name:U,fn:i(l=>[de(n.$slots,U,ce(ue(l)))])})),e(k)?{name:"selected-item",fn:i(Q=>[s("span",{class:pe(["text-primary",n.$q.screen.gt.sm?"text-h6":""])},b(Q.opt[11]),3)]),key:"0"}:void 0]),1040,["model-value","options","label"]))}},xe={class:"row justify-center q-pt-sm"},Qe={class:"col-12 col-md-8"},Ue=s("div",{class:"text-h5 text-dark"},"Post a New Job",-1),Ae=s("div",{class:"text-primary text-h6 q-mb-sm"},"Job Details",-1),Je={class:"row"},Pe={class:"col-12 q-pr-md"},ke={class:"row"},Be={class:"col-12 q-pr-md"},Fe={class:"text-caption"},je={key:0,class:"row"},Oe={class:"col-12 col-md-6 q-pr-md"},Ne={class:"text-caption"},$e={class:"col-12 col-md-6 q-pr-md"},De={class:"text-caption"},Re={key:1,class:"row"},Ee={class:"col-12 col-md-4 q-pr-md"},Ie={class:"text-caption"},Le={class:"col-12 col-md-4 q-pr-md"},Te={class:"col-12 col-md-4 q-pr-md"},ze={class:"text-caption"},Ge={class:"row"},Me={class:"col-12 q-pr-md"},We={class:"text-caption"},He={class:"row"},Ke={class:"col-12 q-pr-md"},Xe={class:"text-caption"},Ye={class:"row"},Ze={class:"col-12 q-pr-md"},et={class:"text-caption"},St={__name:"newJobPost",setup(L){const P=ge(),{userType:_}=Ve(),C=Y(),{fetchCrafts:k,fetchLocations:B,fetchAllLocations:x,fetchJobs:h,fetchJobAliases:V}=C,{getCrafts:w,getSelectedOffice:d,getLocations:n,getJobs:T,getJobAliases:Q}=E(C);M([]),M([]);const U=W(()=>g({location:g().nullable().required().label("Location"),craft:g().nullable().required().label("Craft"),job:g().nullable().label("Job"),alias:g().nullable().required().label("Alias"),street1:v().when("location",{is:t=>t&&t.value===0,then:v().required()}).label("Street Address 1"),street2:v(),city:v().when("location",{is:t=>t&&t.value===0,then:v().required()}).label("City"),state:v().when("location",{is:t=>t&&t.value===0,then:v().required()}).label("State"),postal:v().when("location",{is:t=>t&&t.value===0,then:v().required()}).label("Postal Code")})),{errors:l,handleSubmit:Z,handleReset:ee,isSubmitting:y}=ye({validationSchema:U}),{value:c}=f("location"),{value:u,resetField:te}=f("craft"),{value:p,resetField:oe}=f("job"),{value:F,resetField:se}=f("alias"),{value:j}=f("street1"),{value:O}=f("street2"),{value:N}=f("city"),{value:$}=f("state"),{value:D}=f("postal"),z=t=>{d.value?B({selectedId:d.value[8],refresh:t}):x({can:"read",refresh:t})};d.value&&z(!0),k({refresh:!1}),A(d,()=>{z(!0),ee()}),A(c,()=>{te()}),A(u,()=>{oe(),u.value&&h({selectedId:u.value.value})}),A(p,()=>{se(),p.value&&V({selectedId:p.value.value})});const le=W(()=>{let t=n.value(d.value?d.value[8]:null);const o={...t[0]};return o.label="Custom Location",o.value=0,t=t.concat([o]),t}),ae=Z(async t=>{try{const o=[{12:{value:d.value[8]},14:{value:t.job[3]},16:{value:t.craft[3]},18:{value:t.alias[3]},33:{value:t.location[3]},47:{value:"now"}}];t.location&&t.location.value===0&&(o[0][96]={value:t.street1},o[0][97]={value:t.street2||""},o[0][98]={value:t.city},o[0][99]={value:t.state},o[0][100]={value:t.postal}),console.log(o),G()}catch(o){console.log(o),P.notify({position:"top-right",type:"negative",message:"There was a problem submitting Job Post!"})}}),G=()=>{window.parent&&window.parent.postMessage("refreshData")};return(t,o)=>(q(),I(we,{style:{"max-width":"100vw","max-height":"100vh"}},{default:i(()=>[s("div",xe,[s("div",Qe,[r(fe,{flat:""},{default:i(()=>[r(he,{onSubmit:ve(e(ae),["prevent"])},{default:i(()=>[r(H,{class:"q-pb-lg"},{default:i(()=>[Ue]),_:1}),r(H,{class:"q-pl-lg q-pt-none"},{default:i(()=>[Ae,s("div",Je,[s("div",Pe,[e(_)==="QuickBase User"?(q(),I(Ce,{key:0,can:"read",styleSelection:!1,outlined:"",dense:"",class:"q-mb-md"})):R("",!0)])]),s("div",ke,[s("div",Be,[r(S,{dense:"",outlined:"",label:"Location","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(c),"onUpdate:modelValue":o[0]||(o[0]=a=>m(c)?c.value=a:null),options:le.value,"bottom-slots":"",error:!!e(l).location,disable:e(y)||!e(d)},{error:i(()=>[s("div",Fe,b(e(l).location),1)]),_:1},8,["modelValue","options","error","disable"])])]),e(c)&&e(c).value===0?(q(),K("div",je,[s("div",Oe,[r(J,{label:"Street Address 1",dense:"",outlined:"",modelValue:e(j),"onUpdate:modelValue":o[1]||(o[1]=a=>m(j)?j.value=a:null),error:!!e(l).street1,"bottom-slots":""},{error:i(()=>[s("div",Ne,b(e(l).street1),1)]),_:1},8,["modelValue","error"])]),s("div",$e,[r(J,{label:"Street Address 2",dense:"",outlined:"",modelValue:e(O),"onUpdate:modelValue":o[2]||(o[2]=a=>m(O)?O.value=a:null),error:!!e(l).street2,"bottom-slots":""},{error:i(()=>[s("div",De,b(e(l).street2),1)]),_:1},8,["modelValue","error"])])])):R("",!0),e(c)&&e(c).value===0?(q(),K("div",Re,[s("div",Ee,[r(J,{label:"City",dense:"",outlined:"",modelValue:e(N),"onUpdate:modelValue":o[3]||(o[3]=a=>m(N)?N.value=a:null),error:!!e(l).city,"bottom-slots":""},{error:i(()=>[s("div",Ie,b(e(l).city),1)]),_:1},8,["modelValue","error"])]),s("div",Le,[r(S,{dense:"",outlined:"",label:"State","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e($),"onUpdate:modelValue":o[4]||(o[4]=a=>m($)?$.value=a:null),options:e(qe),"bottom-slots":""},null,8,["modelValue","options"])]),s("div",Te,[r(J,{label:"Postal Code",dense:"",outlined:"",modelValue:e(D),"onUpdate:modelValue":o[5]||(o[5]=a=>m(D)?D.value=a:null),error:!!e(l).postal,"bottom-slots":""},{error:i(()=>[s("div",ze,b(e(l).postal),1)]),_:1},8,["modelValue","error"])])])):R("",!0),s("div",Ge,[s("div",Me,[r(S,{dense:"",outlined:"",label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(u),"onUpdate:modelValue":o[6]||(o[6]=a=>m(u)?u.value=a:null),options:e(w),"bottom-slots":"",error:!!e(l).craft,disable:e(y)||!e(c)},{error:i(()=>[s("div",We,b(e(l).craft),1)]),_:1},8,["modelValue","options","error","disable"])])]),s("div",He,[s("div",Ke,[r(S,{dense:"",outlined:"",label:"Job","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(p),"onUpdate:modelValue":o[7]||(o[7]=a=>m(p)?p.value=a:null),options:e(T)(e(u)?e(u).value:null),"bottom-slots":"",error:!!e(l).job,disable:e(y)||!e(u)},{error:i(()=>[s("div",Xe,b(e(l).job),1)]),_:1},8,["modelValue","options","error","disable"])])]),s("div",Ye,[s("div",Ze,[r(S,{dense:"",outlined:"",label:"Alias","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(F),"onUpdate:modelValue":o[8]||(o[8]=a=>m(F)?F.value=a:null),options:e(Q)(e(p)?e(p).value:null),"bottom-slots":"",error:!!e(l).alias,disable:e(y)||!e(p)},{error:i(()=>[s("div",et,b(e(l).alias),1)]),_:1},8,["modelValue","options","error","disable"])])])]),_:1}),r(be,{class:"q-pl-lg q-py-lg",align:"right"},{default:i(()=>[r(X,{loading:e(y),disable:e(y),color:"primary",label:"Save & Close",type:"submit"},{loading:i(()=>[r(_e)]),_:1},8,["loading","disable"]),r(X,{class:"q-mr-lg",color:"secondary",label:"Cancel",onClick:G})]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])]),_:1}))}};export{St as default};
