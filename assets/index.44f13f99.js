import{Q as N,a as U,b as S}from"./QTabPanels.f08604ff.js";import{Q as z}from"./QTabs.c48e8512.js";import{Q as I}from"./QSpace.a1f8e64a.js";import{l as g,r as w,bU as C,c as v,_ as j,b4 as f,y as b,z as Q,d as o,bq as l,cU as D,B as q,cT as T,v as L,bS as E,ap as h,aq as y}from"./index.48ce5b72.js";import{Q as K}from"./QToolbar.7df6568a.js";import{Q as M}from"./QPage.eef4aa2f.js";import{u as k}from"./use-quasar.468e1258.js";import{u as V}from"./dataStore.e8d02f93.js";import{g as B,u as X,q as G}from"./app.5e67c239.js";import{R as H,a as J}from"./requestDataAlt.c49bb63f.js";import{_ as O}from"./projectSelector.c3a9b73c.js";import{dayjs as W}from"./dayjs.9bb68654.js";import{N as Y}from"./nameRequestData.de976d01.js";import"./use-panel.a2490dda.js";import"./touch.3df10340.js";import"./selection.e8d17b8a.js";import"./QResizeObserver.903c6b28.js";import"./rtl.b51694b1.js";import"./localForage.a179cfc1.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.04bc0a32.js";import"./i18n.0c36ad49.js";import"./QTd.3c8ae2d8.js";import"./QTable.68f70e77.js";import"./QList.1735c3ac.js";import"./QMarkupTable.5a189cd0.js";import"./QSelect.06d0b9ce.js";import"./QChip.d193a000.js";import"./QMenu.62e1eee7.js";import"./position-engine.a6f346a0.js";import"./use-fullscreen.735db5b1.js";import"./QSpinnerGears.8b7dc0e7.js";import"./QTooltip.f21cfa79.js";import"./useQuerySaver.d29ff9ee.js";import"./dataStore.dbb6cf0f.js";const Z=g({props:{},components:{RequestDataTable:H,projectSelector:O},setup(e){const t=k(),u=B(),m=w(null),{getSelectedProject:c}=C(u),{getOpenRequest:p,fetchOpenRequest:a,fetchAllOpenRequest:n}=V(),s=v(()=>c.value?c.value[3]:null),i=v(()=>p(s.value).sort((r,R)=>r[1].$d<R[1].$d?1:-1));async function _(r){t.loading.show(),s.value?await a({projectId:s.value,refresh:r}):await n({refresh:r}),t.loading.hide()}return _(!1),{openRequests:i,projectFilter:m,loadData:_}}}),x={class:"row items-center"},ee={class:"col-12 col-md-4"};function te(e,t,u,m,c,p){const a=f("projectSelector"),n=f("request-data-table");return b(),Q("div",null,[o(T,{flat:""},{default:l(()=>[o(D,null,{default:l(()=>[q("div",x,[q("div",ee,[o(a,{dense:""})])])]),_:1})]),_:1}),o(n,{requests:e.openRequests,status:"Open",onRefreshData:t[0]||(t[0]=s=>e.loadData(!0))},null,8,["requests"])])}var oe=j(Z,[["render",te]]);const ae=g({props:{},components:{RequestDataTableAlt:J,projectSelector:O},setup(e){const t=k(),u=B(),m=w(null),{getSelectedProject:c}=C(u),{getClosedRequest:p,fetchClosedRequest:a,fetchAllClosedRequest:n}=V(),s=v(()=>c.value?c.value[3]:null),i=v(()=>p(s.value).sort((r,R)=>r[1].$d<R[1].$d?1:-1));async function _(r){t.loading.show(),s.value?await a({projectId:s.value,refresh:r}):await n({refresh:r}),t.loading.hide()}return _(),{closedRequests:i,projectFilter:m,loadData:_}}}),se={class:"row items-center"},ne={class:"col-12 col-md-4"};function re(e,t,u,m,c,p){const a=f("projectSelector"),n=f("request-data-table-alt");return b(),Q("div",null,[o(T,{flat:""},{default:l(()=>[o(D,null,{default:l(()=>[q("div",se,[q("div",ne,[o(a,{dense:""})])])]),_:1})]),_:1}),o(n,{requests:e.closedRequests,status:"Completed",onRefreshData:t[0]||(t[0]=s=>e.loadData(!0))},null,8,["requests"])])}var le=j(ae,[["render",re]]);const ue=g({props:{},components:{NameRequestDataTable:Y,projectSelector:O},setup(e){const t=k(),u=B(),{capitalize:m}=L,c=w(null),{userData:p}=X(),{getSelectedProject:a}=C(u),{getNameRequest:n,fetchAllNameRequest:s,removeData:i,fetchNameRequest:_}=V(),r=v(()=>a.value?a.value[3]:null),R=v(()=>n(r.value).sort((d,$)=>d[1].$d<$[1].$d?1:-1));async function A(d){t.loading.show(),r.value?await _({projectId:r.value,refresh:d}):await s({refresh:d}),t.loading.hide()}function P(d){return`${m(d[6].toLowerCase())} ${m(d[7].toLowerCase())}`}async function F(d){t.dialog({title:"Confirm",message:`Are you sure you want to remove ${P(d)} from request# ${d[18]}?`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:$}=await G.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:d[3]},11:{value:!0},12:{value:W().tz("America/Chicago")},13:{value:`${p[35]} ${p[37]}`}}],fieldsToReturn:[15],formatObject:15});i({type:"nameRequest",key:$[0][15][38],item:$[0][15],storageKey:"storageNameRequest"})}catch($){t.notify({type:"negative",message:"Cannot remove name request"}),console.log($)}})}return A(),{nameRequests:R,projectFilter:c,removeName:F,loadData:A}}}),ce={class:"row items-center"},de={class:"col-12 col-md-4"};function me(e,t,u,m,c,p){const a=f("projectSelector"),n=f("name-request-data-table");return b(),Q("div",null,[o(T,{flat:""},{default:l(()=>[o(D,null,{default:l(()=>[q("div",ce,[q("div",de,[o(a,{dense:""})])])]),_:1})]),_:1}),o(n,{requests:e.nameRequests,status:"Named",onRemoveName:e.removeName,onRefreshData:t[0]||(t[0]=s=>e.loadData(!0))},null,8,["requests","onRemoveName"])])}var pe=j(ue,[["render",me]]);const ie=g({name:"Requests",components:{OpenTab:oe,CompleteTab:le,NamesTab:pe},setup(){const e=E(),t=w(0);function u(){e.push({name:"new-request"})}return{tab:t,addNewRequest:u}}}),fe={class:"q-pa-md"};function _e(e,t,u,m,c,p){const a=f("open-tab"),n=f("names-tab"),s=f("complete-tab");return b(),h(M,{style:{"max-width":"100vw"}},{default:l(()=>[q("div",fe,[o(K,{class:"bg-info text-white shadow-2 rounded-borders"},{default:l(()=>[o(z,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=i=>e.tab=i),"bg-color":"none","indicator-color":"accent",dense:e.$q.screen.lt.md},{default:l(()=>[o(N,{name:0,label:e.$q.screen.gt.xs?"Open Requests":"Open"},null,8,["label"]),e.$can("read","nameRequests")?(b(),h(N,{key:0,name:2,label:e.$q.screen.gt.xs?"Named Requests":"Named"},null,8,["label"])):y("",!0),e.$q.screen.gt.sm?(b(),h(N,{key:1,name:3,label:e.$q.screen.gt.xs?"Completed Requests":"Completed"},null,8,["label"])):y("",!0)]),_:1},8,["modelValue","dense"]),o(I),(e.$can("create","projectRequests"),y("",!0))]),_:1}),o(U,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=i=>e.tab=i),animated:""},{default:l(()=>[o(S,{name:0},{default:l(()=>[o(a)]),_:1}),o(S,{name:2},{default:l(()=>[o(n)]),_:1}),o(S,{name:3},{default:l(()=>[o(s)]),_:1})]),_:1},8,["modelValue"])])]),_:1})}var Ze=j(ie,[["render",_e]]);export{Ze as default};
