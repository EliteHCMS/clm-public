import{Q as I}from"./QSpace.eaff1f21.js";import{bU as Z,r as n,w as O,aS as ee,c as C,aP as te,y as _,z as g,d as t,bq as o,cU as ae,B as i,D as U,a7 as d,ab as m,cT as le,cV as Y,bP as oe,bV as y,aw as j,bQ as z,bO as A}from"./index.a03c16e1.js";import{Q as k}from"./QTooltip.9a46f6bc.js";import{a as se}from"./QSelect.b38e663e.js";import{Q as ne}from"./QList.ace1fffd.js";import{Q as ie}from"./QMenu.85d00748.js";import{Q as S}from"./QTd.a2e291df.js";import{u as re}from"./use-quasar.581262ce.js";import{e as ue}from"./export-file.dc78ba05.js";import{c as ce,b as de,_ as F}from"./app.8e730c48.js";import{dayjs as me}from"./dayjs.8e614a0b.js";import{_ as fe}from"./hiringTabs.1718096c.js";import{_ as pe}from"./officeSelector.2ee8121c.js";import{_ as ve}from"./aTable.753a2053.js";import"./position-engine.869e6998.js";import"./selection.a756df5b.js";import"./QChip.2bf5e9f7.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.8d2e0f2e.js";import"./index.04bc0a32.js";import"./i18n.8ef2ea34.js";import"./QBadge.62558377.js";import"./QRouteTab.27e2febb.js";import"./QTabs.ebbf895d.js";import"./QResizeObserver.38a632bf.js";import"./QTable.c2e23d38.js";import"./QMarkupTable.b1b2c50b.js";import"./use-fullscreen.95fc684f.js";const be={class:"q-pa-md"},_e={class:"row items-center"},ge={class:"col-12 col-md-4 q-px-sm"},we={class:"col-12 col-md-3 q-px-sm"},ye={class:"col-12 col-md-5 q-px-sm"},he=i("div",{class:"col-12 col-md-4 q-px-sm"},null,-1),xe={key:0},De={key:1},Qe={key:0},Ve={key:1},at={__name:"index",setup(Ce){const f=re(),P=ce(),{openWindow:M}=de(),{fetchDeployments:R,fetchAllDeployments:E}=P,{getDeployments:h,getSelectedOffice:r,getLoadingState:q}=Z(P),u=n(r.value?r.value[8]:null),x=n("Deployed"),B=n("deployments"),D=n(""),p=n(null),w=n(null),L=n(null),T=n({sortBy:"1",descending:!0,rowsPerPage:150}),c=n(F.uniqBy(h.value(u.value).filter(a=>a[167].toLowerCase().indexOf(w.value)>-1).sort((a,l)=>a[167].localeCompare(l[167])),"167")),v=n(c.value),Q=a=>{u.value?R({selectedId:u.value,refresh:a}):E({can:"read",refresh:a})};Q(!0),O(r,()=>{u.value=r.value?r.value[8]:null,Q()});const J=n(new Date),W=setInterval(()=>{J.value=new Date},1e3);ee(()=>{clearInterval(W)});const G=C(()=>["startTimestamp","name","phoneNumber","project","jobNumber","classification","action","startDate",...r.value?[]:["office"]]),V=C(()=>[{name:"startTimestamp",align:"left",label:"Date Created",field:"1",sortable:!0},{name:"name",align:"left",label:"Name",field:"31",sortable:!1},{name:"phoneNumber",align:"center",label:"Phone Number",field:"42",sortable:!1},{name:"project",align:"center",label:"Project",field:"167",sortable:!1},{name:"jobNumber",align:"center",label:"Job #",field:"85",sortable:!1},{name:"classification",align:"center",label:"Classification",field:"30",sortable:!1},{name:"office",align:"center",label:"Office",field:"68",sortable:!1},{name:"startDate",align:"center",label:"Start Date",field:"33",sortable:!1},{name:"action",align:"center",label:"",sortable:!1}]),b=C(()=>h.value(u.value).filter(a=>{let l=!0,e=!0;return p.value&&(l=a[167]===p.value[167],l||(e=!1)),e}).sort((a,l)=>T.value.descending?a[1].isBefore(l[1]):a[1].isAfter(l[1])));O(b,()=>{te(()=>{c.value=F.uniqBy(h.value(u.value).sort((a,l)=>a[167].localeCompare(l[167])),"167"),v.value=c.value})});const H=(a,l,e)=>{if(a===""){l(()=>{if(w.value=null,v.value.length===c.value.length){e();return}v.value=c.value});return}l(()=>{w.value=a.toLocaleLowerCase(),v.value=c.value.filter(s=>s[167].toLowerCase().indexOf(w.value)>-1).sort((s,X)=>s[167].localeCompare(X[167]))})},$=(a,l,e)=>{let s=l!==void 0?l(a,e):a;return s=s==null?"":String(s),s=s.split('"').join('""'),`"${s}"`},K=a=>{M(null,{url:`https://elitehcms.quickbase.com/db/bs7qsu6wh?a=dbpage&pageID=6&ee=${a[21]}`,name:"View Profile"})},N=()=>{const a=[V.value.map(e=>$(e.label))].concat(b.value.map(e=>V.value.map(s=>$(typeof s.field=="function"?s.field(e):e[s.field===void 0?s.name:s.field],s.format,e)).join(","))).join(`\r
`);ue(`${x.value} ${me().format("MM.DD.YYYY")}.csv`,a,"text/csv")!==!0&&f.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return(a,l)=>(_(),g("div",be,[t(fe),t(le,{flat:"",class:"q-pt-none"},{default:o(()=>[t(ae,null,{default:o(()=>[i("div",_e,[i("div",ge,[i("div",{class:U(["text-dark",d(f).screen.lt.md?"text-body1":"text-h5"])},m(x.value),3)]),t(I),i("div",we,[t(pe,{styleSelection:!0})])])]),_:1})]),_:1}),t(ve,{rows:b.value,columns:V.value,pagination:T.value,filter:D.value,title:x.value,separator:"vertical","row-key":"3",loading:d(q)(B.value),"visible-columns":G.value,downloadButton:!0,onDownload:N},{top:o(()=>[i("div",ye,[t(Y,{dense:d(f).screen.lt.md,modelValue:D.value,"onUpdate:modelValue":l[0]||(l[0]=e=>D.value=e),label:"Search...",clearable:""},{prepend:o(()=>[t(oe,{name:"search"})]),_:1},8,["dense","modelValue"])]),t(I),he,i("div",{class:U(["text-dark text-caption text-italic",d(f).screen.lt.md?"offset-xs-5":""])},"(Total: "+m(b.value.length)+")",3),t(y,{flat:"",round:"",color:"primary",icon:"filter_list"},{default:o(()=>[t(k,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:o(()=>[j(" Filter ")]),_:1}),t(ie,null,{default:o(()=>[t(ne,null,{default:o(()=>[t(z,{style:{"min-width":"450px"}},{default:o(()=>[t(A,null,{default:o(()=>[t(se,{modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=e=>p.value=e),options:v.value,label:p.value?"Project":"Select Project","option-label":"167","option-value":"167","use-input":"",behavior:d(f).platform.is.ios===!0?"dialog":"menu","hide-selected":"","fill-input":"","input-debounce":"0",onFilter:H,clearable:""},null,8,["modelValue","options","label","behavior"])]),_:1})]),_:1}),t(z,null,{default:o(()=>[t(A,null,{default:o(()=>[t(Y,{modelValue:L.value,"onUpdate:modelValue":l[2]||(l[2]=e=>L.value=e),label:"Deployment Date",type:"date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(y,{flat:"",round:"",color:"primary",icon:"download",disable:b.value.length<1,onClick:N},{default:o(()=>[t(k,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:o(()=>[j(" Download ")]),_:1})]),_:1},8,["disable"]),t(y,{flat:"",round:"",color:"primary",icon:"refresh",onClick:l[3]||(l[3]=e=>Q(!0)),loading:d(q)(B.value)},{default:o(()=>[t(k,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:o(()=>[j(" Refresh ")]),_:1})]),_:1},8,["loading"])]),"body-cell-startTimestamp":o(e=>[t(S,{props:e},{default:o(()=>[a.$dayjs(e.value).isValid()?(_(),g("div",xe,m(e.value.format("L LT")),1)):(_(),g("div",De,m(e.row[1].format("L LT")),1))]),_:2},1032,["props"])]),"body-cell-startDate":o(e=>[t(S,{props:e},{default:o(()=>[a.$dayjs(e.value).isValid()?(_(),g("div",Qe,m(e.value.format("L")),1)):(_(),g("div",Ve,m(e.row[1].format("L")),1))]),_:2},1032,["props"])]),"body-cell-action":o(e=>[t(S,{props:e},{default:o(()=>[t(y,{color:"primary",label:"View Profile",onClick:s=>K(e.row),size:".75rem"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","loading","visible-columns"])]))}};export{at as default};
