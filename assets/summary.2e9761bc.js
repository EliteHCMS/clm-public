import{Q as G}from"./QPage.f4574d3b.js";import{l as C,r as R,c as m,_ as S,b5 as A,A as t,aq as d,br as c,B as r,D as i,G as q,ac as g,bW as L,ar as Y,H as K,cT as w,bU as j,d as $,F as I,b4 as V,cS as M,cV as X,bt as Z,bR as ee,bP as H,ax as te,bQ as T,da as ae,ab as F,aH as O,bT as le,y as se}from"./index.62f4c3c5.js";import{q as z}from"./app.ae0068fa.js";import{u as N}from"./dataStore.423cc352.js";import{Q as oe}from"./QInnerLoading.e16d5622.js";import{dayjs as b}from"./dayjs.b3414925.js";import{u as J}from"./useQuerySaver.d29ff9ee.js";import{E as ie}from"./form-edit-card-section.abf3560b.js";import{Q as ne}from"./QRating.86ebca6d.js";import{Q as re}from"./QList.11a66c2b.js";import{d as ue,f as ce}from"./helpers.510249e6.js";import{u as de}from"./index.02476a3a.js";import{d as me}from"./decode.3998c82c.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.f977d509.js";import"./api.646f206c.js";import"./index.04bc0a32.js";import"./i18n.3f666946.js";import"./QSelect.63d295fd.js";import"./QChip.9ae5b419.js";import"./QMenu.83b714c5.js";import"./position-engine.9f816e9b.js";import"./selection.3494d29b.js";import"./rtl.b51694b1.js";import"./QForm.617a9252.js";import"./vee-validate.esm.bd7c3d30.js";import"./array.5117e02c.js";const pe=C({emits:[],props:{item:Object},components:{EditDetailsForm:ie},setup(e,{emit:u}){const n=R(!1),p=m(()=>{const{permission:o}=e.item.editable&&e.item.config?e.item.config:{action:null,subject:null};return o});return{edit:n,permission:p}}}),ve={key:0,class:"row"},fe={class:"col-12 col-md-4"},ye={class:"col-12 col-md-8"},be={key:0},$e={key:1};function ge(e,u,n,p,o,v){const a=A("edit-details-form");return t(),d(w,K(e.$attrs,{class:e.$attrs.class||"q-pa-sm"}),{default:c(()=>[e.edit?(t(),d(a,{key:1,type:e.item.label,config:e.item.config,onCancelEdit:u[1]||(u[1]=l=>e.edit=!1)},null,8,["type","config"])):(t(),r("div",ve,[i("div",fe,[i("div",null,[i("span",{class:q(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(e.item.label),3)])]),i("div",ye,[i("div",null,[e.item.action&&e.item.permission?(t(),r("span",{key:0,class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},[e.$can(`${e.item.action}`,`${e.item.permission}`)?(t(),r("span",be,g(e.item.value===""?"N/A":e.item.value),1)):(t(),r("span",$e,"*******"))],2)):(t(),r("span",{key:1,class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(e.item.value===""?"N/A":e.item.value),3)),e.item.editable&&e.$can(e.permission.action,e.permission.subject)?(t(),d(L,{key:2,color:"accent",flat:"",dense:"",round:"",icon:"edit",size:"sm",onClick:u[0]||(u[0]=l=>e.edit=!0)})):Y("",!0)])])]))]),_:1},16,["class"])}var U=S(pe,[["render",ge]]);const he=C({components:{CardSectionEditable:U},props:{employee:Object},setup(e){const u=j(),n=R(!0),{getWorkdayData:p,updateViewedEmployees:o,getEmployee:v,getAssignmentsByEmployee:a,setAssignmentsByEmployee:l}=N(),f=m(()=>u.params.id||e.employee[3]),h=m(()=>v(f.value)),s=m(()=>h.value?h.value.currentAssignment?h.value.currentAssignment:a(f.value)?a(f.value):null:null),y=m(()=>{const D=p(f.value);if(D){const{employmentData:x}=D,{positionData:P,workerStatus:Q}=x,{jobProfile:B}=P;return[{label:"Position",value:`${P.positionId} ${P.positionTitle}`},{label:"Job Profile",value:`${B.jobProfileId} - ${B.jobProfileName}`},{label:"Hire Date",value:b(Q.hireDate).format("MM/DD/YYYY")},{label:"Original Hire Date",value:b(Q.originalHireDate).format("MM/DD/YYYY")},{label:"Years Since Last Hire",value:b().diff(Q.hireDate,"year",!0).toFixed(2)}]}else return[]}),_=D=>D[145].$d?b(D[145].$d).format("MM/DD/YYYY"):b(D[1].$d).format("MM/DD/YYYY"),k=D=>D[145].$d?b().diff(D[145].$d,"day"):b().diff(D[1].$d,"day"),E=m(()=>s.value&&h.value[79]===7?[{label:"Project",value:s.value[146]},{label:"Current Location",value:s.value[141]},{label:"Job Title",value:s.value[20]},{label:"Current Supervisor",value:s.value[140]===""?"N/A":s.value[140]},{label:"Arrival Date",value:_(s.value)},{label:"Days on Site",value:`${k(s.value)}`},{label:"Rate",value:s.value[116],action:"read",permission:"rates"}]:[]),W=m(()=>E.value.concat(y.value));return(async()=>{if(!s.value&&h.value&&h.value[577]){const{data:D}=await z.fetchFromHiringApp({fields:[J({type:"rawAssignments",query:"",id:h.value[577]})]});o({id:h.value[3],dataset:"currentAssignment",data:D}),l({id:h.value[3],data:D}),n.value=!1}else n.value=!1})(),{loading:n,details:W}}}),_e=i("div",{class:"text-h6 text-weight-bold"},"Job Details",-1),De=i("div",{class:"text-body1 text-primary text-italic"},"Employee has a pending release.",-1);function ke(e,u,n,p,o,v){const a=A("card-section-editable");return t(),r("div",null,[$(M,null,{default:c(()=>[$(w,{class:"q-pb-sm"},{default:c(()=>[_e]),_:1}),e.employee[581]?(t(),d(w,{key:0,class:"q-py-sm"},{default:c(()=>[De]),_:1})):Y("",!0),(t(!0),r(I,null,V(e.details,l=>(t(),r(I,{key:l},[e.loading?Y("",!0):(t(),d(a,{key:0,item:l},null,8,["item"]))],64))),128)),e.loading?(t(),d(w,{key:1,style:{height:"200px"}},{default:c(()=>[$(oe,{showing:"",color:"primary",label:"Loading Details"})]),_:1})):Y("",!0)]),_:1})])}var we=S(he,[["render",ke]]);const Ye=C({props:{employee:Object},components:{},setup(e){const{getReleases:u,setReleases:n}=N(),p=l=>l[86].$d?b(l[86].$d).format("MM/DD/YYYY"):b(l[62].$d).format("MM/DD/YYYY"),o=m(()=>u(e.employee[581])),v=m(()=>{let l;return o.value&&o.value[3]?l=[{label:"Project",value:o.value[83]},{label:"Location",value:o.value[84]},{label:"Job Title",value:o.value[82]},{label:"Reason",value:o.value[32]},{label:"Arrival Date",value:p(o.value)},{label:"Last Hire Date",value:b(e.employee[397].$d).format("MM/DD/YYYY")},{label:"Last Day On Site",value:b(o.value[36].$d).format("MM/DD/YYYY")},{label:"Returned Equipment",value:o.value[72]?"Yes":"No"},{label:"Pay Deduct Needed",value:!o.value[72]&&b.duration(b(o.value[36].$d).diff(b(e.employee[397].$d))).asDays()<30?"Yes":"No"},{label:"CAAP Rating",value:o.value[59]&&o.value[59].length>0?o.value[59][0][37]:0,type:"rating"},{label:"Submitted By",value:`${o.value[38][35]} ${o.value[38][37]}`},{label:"Submitted On",value:b(o.value[1].$d).tz(b.tz.guess()).format("MM/DD/YYYY hh:mm a")},{label:"Comments",value:o.value[60],type:"comments"}]:l=[],l});return(async()=>{if(!o.value&&e.employee[581]){const{data:l}=await z.fetchFromHiringApp({fields:[J({type:"releases",query:"",id:e.employee[581]})]},{action:"read",type:"release"});n({id:l[3],data:l})}})(),{releaseDetails:v,release:o,downloadFile:ue}}}),Ie={class:"row items-center"},qe=i("div",{class:"col-12 col-md-7"},[i("div",{class:"text-h6 text-weight-bold"},"Pending Release Details")],-1),Ae={key:0,class:"col-12 col-md-5"},Ce={class:"row"},Se={class:"col-12 col-md-5"},Ve={class:"text-body2"},Ee={class:"col-12 col-md-7"},Ne={key:0},je={key:1,class:"text-body2 text-weight-light"},Me={key:1,class:"text-body2 text-weight-light"},Pe={class:"text-body1 text-weight-bold q-mb-xs"},Qe={class:"text-body2 text-italic text-primary q-pl-md"},Re=i("div",{class:"text-body1 text-weight-bold q-mb-xs"},"Supporting Docs",-1);function Be(e,u,n,p,o,v){return t(),r("div",null,[$(M,{class:"text-dark"},{default:c(()=>[$(w,{class:"q-pb-sm"},{default:c(()=>[i("div",Ie,[qe,e.release?(t(),r("div",Ae,[$(X,{align:"right"},{default:c(()=>[$(L,{size:"md",flat:"",dense:"",label:"View Release",color:"info",to:{name:"view-ee-release",params:{id:e.release[25],release:e.release[3]}}},null,8,["to"])]),_:1})])):Y("",!0)])]),_:1}),(t(!0),r(I,null,V(e.releaseDetails,a=>(t(),r(I,{key:a},[a.type!=="comments"?(t(),d(w,{key:0,class:"q-py-sm"},{default:c(()=>[i("div",Ce,[i("div",Se,[i("div",Ve,g(a.label),1)]),i("div",Ee,[a.type==="rating"?(t(),r("div",Ne,[a.value>0?(t(),d(ne,{key:0,modelValue:a.value,"onUpdate:modelValue":l=>a.value=l,max:"5",size:"sm",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(t(),r("div",je,"Not Available"))])):(t(),r("div",Me,g(a.value),1))])])]),_:2},1024)):a.value!==""?(t(),d(w,{key:1},{default:c(()=>[i("div",Pe,g(a.label),1),i("div",Qe,g(a.value),1)]),_:2},1024)):Y("",!0)],64))),128)),e.release&&e.release[70].length>0?(t(),d(w,{key:0},{default:c(()=>[Re,$(re,null,{default:c(()=>[(t(!0),r(I,null,V(e.release[70],(a,l)=>Z((t(),d(ee,{key:l,clickable:"",class:"text-body2",onClick:f=>e.downloadFile({tableId:"bsstsai5d",recordId:a[3],fieldId:6,versionNumber:1,name:a[7]})},{default:c(()=>[$(H,null,{default:c(()=>[te(g(l+1)+". "+g(a[7]),1)]),_:2},1024),$(H,{avatar:""},{default:c(()=>[$(T,{color:"info",name:"file_download"})]),_:1})]),_:2},1032,["onClick"])),[[ae]])),128))]),_:1})]),_:1})):Y("",!0)]),_:1})])}var He=S(Ye,[["render",Be]]);const Le=C({emits:[],props:{item:Object},components:{},setup(e,{emit:u}){const n=R(!1),{can:p}=de(),o=m(()=>{if(e.item.config){const{permission:a}=e.item.config;return a?p(a.action,a.subject):!0}else return!0});return{visible:n,hasPermission:o,toggleVisibility:()=>{n.value?n.value=!1:(n.value=!0,setTimeout(()=>{n.value=!1},5e3))}}}}),Te={key:0},Fe={key:1};function Oe(e,u,n,p,o,v){return t(),r("div",null,[e.item.protected?(t(),r("div",Te,[e.visible?(t(),r("span",{key:0,class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(e.item.value===""?"N/A":e.item.value),3)):(t(),r("span",{key:1,class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(e.item.hiddenValue===""?"N/A":e.item.hiddenValue),3)),e.hasPermission?(t(),d(T,{key:2,class:"cursor-pointer q-ml-sm",color:"accent",name:e.visible?"visibility_off":"visibility",size:"sm",onClick:e.toggleVisibility},null,8,["name","onClick"])):Y("",!0)])):(t(),r("div",Fe,[i("span",{class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(e.item.value===""?"N/A":e.item.value),3)]))])}var ze=S(Le,[["render",Oe]]);const Je=C({props:{employee:Object},components:{CardSectionValue:ze},setup(e){const u=j(),{getWorkdayData:n,getEmployee:p}=N(),o=({id:s,idType:y})=>y.includes("J&amp;E")?`${s.slice(1,4)} / ${s.slice(-5)}`:s,v=s=>{const y=s.slice(0,3),_=s.slice(3,5),k=s.slice(-4);return`${y}-${_}-${k}`},a=m(()=>u.params.id||e.employee[3]),l=m(()=>p(a.value));m(()=>{const s=n(a.value);if(s){const{personalData:y}=s,{nationalIDData:_}=y.identificationData?y.identificationData:{nationalIDData:null};if(_){const k=_;return{label:k.idType,value:v(k.id),protected:!0,allowView:!0,hiddenValue:`***-**-${k.id.slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}}}else return null}else return null});const f=m(()=>{let s;return l.value?s=[{label:"Workday ID",value:l.value[378],hideIfBlank:!0},{label:"USA-SSN",value:l.value[109].length===9?v(l.value[109]):"",protected:!0,allowView:!0,hiddenValue:"***-**-****",hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}},{label:"CAN-SIN",value:l.value[567]&&l.value[567].length===9?v(l.value[567]):"",protected:!0,allowView:!0,hiddenValue:`***-**-${l.value[567].slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}}]:s=[],s}),h=m(()=>{const s=n(a.value);if(s){const{personalData:y}=s;if(y){const{customIds:_}=y.identificationData?y.identificationData:{customIds:[]};return _}else return[]}else return[]});return{standardIds:f,customIds:h,decodeHTML:me,processCustomID:o}}}),Ue=i("div",{class:"text-h6 text-weight-bold"},"IDs",-1),We={class:"row"},xe={class:"col-12 col-md-4"},Ge={class:"col-12 col-md-8"},Ke={class:"row"},Xe={class:"col-12 col-md-4"},Ze={class:"col-12 col-md-8"};function et(e,u,n,p,o,v){const a=A("card-section-value");return t(),d(M,F(O(e.$attrs)),{default:c(()=>[$(w,{class:"q-pb-sm"},{default:c(()=>[Ue]),_:1}),(t(!0),r(I,null,V(e.standardIds,(l,f)=>(t(),r(I,{key:f},[!l.hideIfBlank||l.value!==""?(t(),d(w,{key:0,class:"q-py-sm"},{default:c(()=>[i("div",We,[i("div",xe,[i("div",{class:q(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(l.label),3)]),i("div",Ge,[$(a,{item:l},null,8,["item"])])])]),_:2},1024)):Y("",!0)],64))),128)),(t(!0),r(I,null,V(e.customIds,(l,f)=>(t(),d(w,{key:f,class:"q-py-sm"},{default:c(()=>[i("div",Ke,[i("div",Xe,[i("div",{class:q(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(e.decodeHTML(l.idType)),3)]),i("div",Ze,[i("div",{class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},g(e.processCustomID(l)),3)])])]),_:2},1024))),128))]),_:1},16)}var tt=S(Je,[["render",et]]);const at=C({components:{CardSectionEditable:U},props:{employee:Object},setup(e){le();const u=j(),{capitalize:n}=se,{updateViewedEmployees:p,getEmployee:o}=N(),v=m(()=>u.params.id||e.employee[3]),a=m(()=>o(v.value)),l=s=>{const y=s.split(" ");let _="";return y.forEach((k,E)=>{_+=E>0?` ${n(k.toLowerCase())}`:n(k.toLowerCase())}),_},f=s=>{const y=s[20]||"",_=s[21]&&s[21]!==""?` ${s[21]}`:"",k=s[22]&&s[22]!==""?` ${s[22]}`:"",E=s[23]&&s[23]!==""?` ${s[23]}`:"";return`${y}${_}${k}${E}`};return{details:m(()=>{let s;return a.value?s=[{label:"Full Name",value:ce(f(a.value))},{label:"Phone",value:a.value[25]},{label:"Email",value:a.value[26]},{label:"Address",value:l(a.value[40]),action:"read",permission:"protectedInformation"},{label:"Primary Craft",value:a.value[52]},{label:"Hiring Status",value:a.value[80]},{label:"Employment Status",value:a.value[408]}]:s=[],s})}}}),lt=i("div",{class:"text-h6 text-weight-bold"},"Employee Information",-1);function st(e,u,n,p,o,v){const a=A("card-section-editable");return t(),d(M,F(O(e.$attrs)),{default:c(()=>[$(w,{class:"q-pa-sm"},{default:c(()=>[lt]),_:1}),(t(!0),r(I,null,V(e.details,(l,f)=>(t(),r(I,{key:f},[l.label==="Address"&&e.$can("read","protectedInformation")?(t(),d(a,{key:0,item:l},null,8,["item"])):(t(),d(a,{key:1,item:l},null,8,["item"]))],64))),128))]),_:1},16)}var ot=S(at,[["render",st]]);const it=C({components:{EmployeeJobDetails:we,PendingReleaseDetails:He,EmployeeIdentificationCard:tt,FullEmployeeCard:ot},setup(){const e=j(),{getEmployee:u}=N();return{employee:m(()=>u(e.params.id))}}}),nt={class:"q-pa-sm"},rt={key:0,class:"row"},ut={class:"col-12 col-md-6 q-px-sm"},ct={class:"col-12 col-md-6 q-px-sm"};function dt(e,u,n,p,o,v){const a=A("full-employee-card"),l=A("employee-identification-card"),f=A("employee-job-details"),h=A("pending-release-details");return t(),d(G,{style:{"max-width":"100vw"}},{default:c(()=>[i("div",nt,[e.employee?(t(),r("div",rt,[i("div",ut,[$(a,{employee:e.employee},null,8,["employee"]),$(l,{class:"q-mt-md",employee:e.employee},null,8,["employee"])]),i("div",ct,[e.employee[408]==="Active"&&!e.employee[581]?(t(),d(f,{key:0,employee:e.employee},null,8,["employee"])):Y("",!0),e.employee[408]==="Active"&&e.employee[581]?(t(),d(h,{key:1,employee:e.employee},null,8,["employee"])):Y("",!0)])])):Y("",!0)])]),_:1})}var Ht=S(it,[["render",dt]]);export{Ht as default};
