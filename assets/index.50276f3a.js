import{Q as P}from"./QSpace.eaff1f21.js";import{bU as re,r as c,w as ce,aS as fe,c as S,y as f,z as w,d as e,bq as l,cU as V,B as i,D as H,a7 as v,ab as d,cT as $,bQ as _,aa as me,aG as ve,bO as r,ds as _e,cV as pe,bP as B,bV as K,aw as s,bR as be,aq as m,ap as I}from"./index.a03c16e1.js";import{a as Q,Q as u}from"./QSelect.b38e663e.js";import{Q as X}from"./QTooltip.9a46f6bc.js";import{Q as G}from"./QList.ace1fffd.js";import{Q as x}from"./QTd.a2e291df.js";import{Q as we}from"./QBtnDropdown.d1bed3f7.js";import{u as he}from"./use-quasar.581262ce.js";import{e as ge}from"./export-file.dc78ba05.js";import{c as ke,b as ye,q as J}from"./app.8e730c48.js";import{_ as xe}from"./officeSelector.2ee8121c.js";import{_ as Ce}from"./aTable.753a2053.js";import{dayjs as C}from"./dayjs.8e614a0b.js";import"./QChip.2bf5e9f7.js";import"./QMenu.85d00748.js";import"./position-engine.869e6998.js";import"./selection.a756df5b.js";import"./rtl.b51694b1.js";import"./QBtnGroup.0fe3d887.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.8d2e0f2e.js";import"./index.04bc0a32.js";import"./i18n.8ef2ea34.js";import"./QTable.c2e23d38.js";import"./QMarkupTable.b1b2c50b.js";import"./use-fullscreen.95fc684f.js";const Se={class:"q-pa-md"},Ve={class:"row items-center"},Ie={class:"col-12 col-md-6 q-px-sm"},Qe=i("div",{class:"col-12 col-md-4 q-px-sm"},null,-1),Te={class:"row items-center"},Ae={class:"col-12 col-md-3 q-px-sm"},qe={class:"col-12 col-md-3 q-px-sm"},De={class:"col-12 col-md-3 q-px-sm"},Pe={class:"col-12 col-md-5 q-px-sm"},$e={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Be=i("br",null,null,-1),Ue=i("br",null,null,-1),Ne=i("br",null,null,-1),Oe={key:0},Re={key:0},Me=i("br",null,null,-1),Le=i("br",null,null,-1),We={key:0},ze={key:0},Ye={key:1},hl={__name:"index",setup(Fe){const h=he(),U=ke(),{openWindow:N}=ye(),{fetchSelfCheckIns:Z,fetchAllSelfCheckIns:ee}=U,{getSelfCheckIns:le,getSelectedOffice:g,getLoadingState:O}=re(U),k=c(g.value?g.value[8]:null),T=c("Self Check-Ins"),R=c("selfCheckIns"),A=c(""),M=c({sortBy:"13",descending:!1,rowsPerPage:150}),q=t=>{k.value?Z({selectedId:k.value,refresh:t}):ee({can:"read",refresh:t})};q(!0),ce(g,()=>{k.value=g.value?g.value[8]:null,q()});const L=c(new Date),ae=setInterval(()=>{L.value=new Date},1e3);fe(()=>{clearInterval(ae)});const p=c("Waiting"),te=c(["Waiting","Called"]),oe=c(["Waiting","Called","All"]),y=c([]),W=c([{label:"Kiosk",value:"Kiosk"},{label:"In Process",value:"In Process"},{label:"Deployment",value:"Deployment"},{label:"AMS",value:"AMS"},{label:"No Task Assigned",value:""}]),D=S(()=>[{name:"index",align:"left",label:"#",sortable:!1,headerStyle:"width: 50px !important;"},{name:"timeCheckIn",align:"left",label:"Time Checked-In",field:"13",sortable:!1,headerStyle:"width: 150px !important;"},{name:"name",align:"left",label:"Name",field:"17",sortable:!1},{name:"phoneNumber",align:"center",label:"Phone Number",field:"6",sortable:!1,headerStyle:"width: 150px !important;"},{name:"reason",align:"center",label:"Reason",field:"10",sortable:!1},{name:"status",align:"center",label:"Status",field:"15",sortable:!1,headerStyle:"width: 150px !important;"},{name:"task",align:"center",label:"Task",field:"27",sortable:!1,headerStyle:"width: 300px !important;"},...p.value==="Called"||p.value==="All"?[{name:"timeCheckedOut",align:"center",label:"Time Checked Out",field:"14",sortable:!1}]:[],{name:"action",align:"center",label:"",sortable:!1,headerStyle:"width: 150px !important;"}]),b=S(()=>le.value(k.value).filter(t=>{let o=!0,a=!0;return p.value&&(p.value==="All"?o=!0:o=t[15]===p.value,o||(a=!1)),y.value&&y.value.length!==0&&(o=y.value.some(n=>t[27]===n.value),o||(a=!1)),a}).sort((t,o)=>M.value.descending?t[13].isBefore(o[13]):t[13].isAfter(o[13]))),z=S(()=>b.value.map(t=>C(L.value).to(t[13]))),Y=S(()=>b.value.map(t=>t[14]?C(t[13]).to(t[14],!0):"N/A")),ne=async(t,o)=>{const a=t==="Called"?Date():"";await J.upsertRecordsXML({to:"br26nivmr",data:[{3:{value:o.row[3]},14:{value:t==="Called"?"now":""},15:{value:t}}],fieldsToReturn:[3,15]}),o.row[15]=t,o.row[14]=a},se=async(t,o)=>{await J.upsertRecordsXML({to:"br26nivmr",data:[{3:{value:o.row[3]},27:{value:t.value}}],fieldsToReturn:[3,27]}),o.row[27]=t.value},F=t=>{N(null,{url:`https://elitehcms.quickbase.com/db/bs7qsu6wh?a=dbpage&pageID=6&ee=${t[16]}`,name:"View Profile"})},ue=t=>{N(null,{url:`https://elitehcms.quickbase.com/db/bpz457c9d?a=dbpage&pageID=22&cid=${t[16]}&page_id=10&office_id=${k.value||0}&type=ee`,name:"Full Profile"})},j=(t,o,a)=>{let n=o!==void 0?o(t,a):t;return n=n==null?"":String(n),n=n.split('"').join('""'),`"${n}"`},E=()=>{const t=[D.value.map(a=>j(a.label))].concat(b.value.map(a=>D.value.map(n=>j(typeof n.field=="function"?n.field(a):a[n.field===void 0?n.name:n.field],n.format,a)).join(","))).join(`\r
`);ge(`${T.value} ${C().format("MM.DD.YYYY")}.csv`,t,"text/csv")!==!0&&h.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return(t,o)=>(f(),w("div",Se,[e($,{flat:"",class:"q-pt-none"},{default:l(()=>[e(V,null,{default:l(()=>[i("div",Ve,[i("div",Ie,[i("div",{class:H(["text-dark",v(h).screen.lt.md?"text-body1":"text-h5"])},d(T.value),3)]),e(P),Qe])]),_:1})]),_:1}),e($,{flat:""},{default:l(()=>[e(V,null,{default:l(()=>[i("div",Te,[i("div",Ae,[e(Q,{label:"Select Status",modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=a=>p.value=a),options:oe.value},null,8,["modelValue","options"])]),i("div",qe,[e(Q,{label:"Select Task",modelValue:y.value,"onUpdate:modelValue":o[1]||(o[1]=a=>y.value=a),options:W.value,multiple:"","use-chips":"",clearable:""},{option:l(({itemProps:a,opt:n,selected:ie,toggleOption:de})=>[e(_,me(ve(a)),{default:l(()=>[e(r,null,{default:l(()=>[e(u,{innerHTML:n.label},null,8,["innerHTML"])]),_:2},1024),e(r,{side:""},{default:l(()=>[e(_e,{"model-value":ie,"onUpdate:modelValue":je=>de(n)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),e(P),i("div",De,[e(xe,{can:"read",styleSelection:!0})])])]),_:1})]),_:1}),e(Ce,{rows:b.value,columns:D.value,pagination:M.value,filter:A.value,title:T.value,separator:"vertical","row-key":"3",grid:!v(h).screen.gt.sm,loading:v(O)(R.value),downloadButton:!0,onDownload:E},{top:l(()=>[i("div",Pe,[e(pe,{dense:v(h).screen.lt.md,modelValue:A.value,"onUpdate:modelValue":o[2]||(o[2]=a=>A.value=a),label:"Search...",clearable:""},{prepend:l(()=>[e(B,{name:"search"})]),_:1},8,["dense","modelValue"])]),e(P),i("div",{class:H(["text-dark text-caption text-italic",v(h).screen.lt.md?"offset-xs-5":""])},"(Total: "+d(b.value.length)+")",3),e(K,{flat:"",round:"",color:"primary",icon:"download",disable:b.value.length<1,onClick:E},{default:l(()=>[e(X,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[s(" Download ")]),_:1})]),_:1},8,["disable"]),e(K,{flat:"",round:"",color:"primary",icon:"refresh",onClick:o[3]||(o[3]=a=>q(!0)),loading:v(O)(R.value)},{default:l(()=>[e(X,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[s(" Refresh ")]),_:1})]),_:1},8,["loading"])]),item:l(a=>[i("div",$e,[e($,null,{default:l(()=>[e(V,{class:"text-center"},{default:l(()=>[i("strong",null,d(a.row[17]),1),Be,i("span",null,d(a.row[15]),1)]),_:2},1024),e(be),e(V,{class:"flex flex-center"},{default:l(()=>[e(G,{dense:""},{default:l(()=>[e(_,null,{default:l(()=>[e(r,null,{default:l(()=>[e(u,null,{default:l(()=>[s("Time Checked-In")]),_:1}),Ue,e(u,null,{default:l(()=>[s("\xA0")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(u,{caption:""},{default:l(()=>[s(d(a.row[13].format("h:mm:ss A")),1)]),_:2},1024),Ne,e(u,{caption:""},{default:l(()=>[s(d(z.value[a.rowIndex]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(_,null,{default:l(()=>[e(r,null,{default:l(()=>[e(u,null,{default:l(()=>[s("Phone Number")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(u,{caption:""},{default:l(()=>[s(d(a.row[20]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(_,null,{default:l(()=>[e(r,null,{default:l(()=>[e(u,null,{default:l(()=>[s("Reason")]),_:1}),a.row[10]==="Applying"?(f(),w("br",Oe)):m("",!0),a.row[10]==="Applying"?(f(),I(u,{key:1},{default:l(()=>[s("\xA0")]),_:1})):m("",!0)]),_:2},1024),e(r,{side:""},{default:l(()=>[e(u,{caption:""},{default:l(()=>[s(d(a.row[10]),1)]),_:2},1024),a.row[10]==="Applying"?(f(),w("br",Re)):m("",!0),a.row[10]==="Applying"?(f(),I(u,{key:1,caption:""},{default:l(()=>[s(d(a.row[11]),1)]),_:2},1024)):m("",!0)]),_:2},1024)]),_:2},1024),e(_,null,{default:l(()=>[e(r,null,{default:l(()=>[e(u,null,{default:l(()=>[s("Task")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(u,{caption:""},{default:l(()=>[s(d(a.row[20]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a.row[15]==="Called"?(f(),I(_,{key:0},{default:l(()=>[e(r,null,{default:l(()=>[e(u,null,{default:l(()=>[s("Time Checked-Out")]),_:1}),Me,e(u,null,{default:l(()=>[s("\xA0")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(u,{caption:""},{default:l(()=>[s(d(a.row[14].format("h:mm:ss A")),1)]),_:2},1024),Le,e(u,{caption:""},{default:l(()=>[s("Wait: "+d(Y.value[a.rowIndex]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):m("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"body-cell-timeCheckIn":l(a=>[e(x,{props:a},{default:l(()=>[i("div",null,d(a.value.format("h:mm:ss A")),1),a.row[15]==="Waiting"?(f(),w("div",We,d(z.value[a.rowIndex]),1)):m("",!0)]),_:2},1032,["props"])]),"body-cell-status":l(a=>[e(x,{props:a},{default:l(()=>[e(Q,{dense:"",filled:"","model-value":a.value,"onUpdate:modelValue":n=>ne(n,a),options:te.value},null,8,["model-value","onUpdate:modelValue","options"])]),_:2},1032,["props"])]),"body-cell-task":l(a=>[e(x,{props:a},{default:l(()=>[e(Q,{dense:"",filled:"","model-value":a.value,"onUpdate:modelValue":n=>se(n,a),options:W.value},null,8,["model-value","onUpdate:modelValue","options"])]),_:2},1032,["props"])]),"body-cell-timeCheckedOut":l(a=>[e(x,{props:a},{default:l(()=>[a.row[15]==="Called"?(f(),w("div",ze,d(v(C)(a.value).isValid()?v(C)(a.value).format("h:mm:ss A"):a.value),1)):m("",!0),a.row[15]==="Called"?(f(),w("div",Ye," Wait: "+d(Y.value[a.rowIndex]),1)):m("",!0)]),_:2},1032,["props"])]),"body-cell-action":l(a=>[e(x,{props:a},{default:l(()=>[a.row[16]?(f(),I(we,{key:0,split:"",color:"primary",label:"View Profile","menu-anchor":"bottom right",onClick:n=>F(a.row),size:".75rem"},{default:l(()=>[e(G,{class:"text-primary",separator:"",bordered:""},{default:l(()=>[e(_,{clickable:"",onClick:n=>F(a.row)},{default:l(()=>[e(r,{avatar:""},{default:l(()=>[e(B,{name:"person"})]),_:1}),e(r,null,{default:l(()=>[e(u,null,{default:l(()=>[s("CEM View Profile")]),_:1})]),_:1})]),_:2},1032,["onClick"]),e(_,{clickable:"",onClick:n=>ue(a.row)},{default:l(()=>[e(r,{avatar:""},{default:l(()=>[e(B,{name:"badge"})]),_:1}),e(r,null,{default:l(()=>[e(u,null,{default:l(()=>[s("Full Profile")]),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])):m("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","grid","loading"])]))}};export{hl as default};
