import{Q as K,a as ye,b as X}from"./QTabPanels.f4cc6ed4.js";import{Q as $e}from"./QTabs.a9fb45b3.js";import{Q as we}from"./QToolbar.50e50760.js";import{Q as he}from"./QPage.d83c4250.js";import{bS as te,bU as G,r as c,w as S,o as oe,y as z,z as se,d as t,bq as i,cU as ne,B as u,cV as H,cT as re,bP as j,a7 as B,ab as P,bV as O,v as ie,c as De,aP as Z,D as _e,ap as fe,aw as ee,aq as xe}from"./index.8e33b0c3.js";import{Q as A}from"./QTd.ad255b63.js";import{Q as de}from"./QInnerLoading.86997952.js";import{Q as ce}from"./QTable.55a4462a.js";import{u as ue}from"./use-quasar.cb503685.js";import{e as me}from"./export-file.dc78ba05.js";import{dayjs as y}from"./dayjs.5512aee7.js";import{c as pe,b as Ne,u as be,i as ve}from"./app.b339b179.js";import{_ as ke}from"./projectSelector.f13d1924.js";import{Q as ae}from"./QSpace.54367268.js";import{Q as le}from"./QTooltip.f2b16a34.js";import"./QSelect.8316c945.js";import{_ as Re}from"./officeMultiSelector.0d7acf9f.js";import"./use-panel.5b38453a.js";import"./touch.3df10340.js";import"./selection.4231ac67.js";import"./QResizeObserver.e268dbef.js";import"./rtl.b51694b1.js";import"./QList.84cef65e.js";import"./QMarkupTable.bfddb59b.js";import"./use-fullscreen.95b8bb98.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.aedf7e5a.js";import"./index.04bc0a32.js";import"./i18n.3befcc18.js";import"./position-engine.c86eec0a.js";import"./QChip.12e4a464.js";import"./QMenu.d82e9973.js";const Ie={class:"row items-center"},Ye={class:"col-12 col-md-3 q-px-sm"},Ce={class:"col-12 col-md-3 q-px-sm"},Se={class:"col-12 col-md-3 q-px-sm"},Pe=u("div",{class:"col-12 col-md-3 q-px-sm"},null,-1),qe={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},Ve={class:"text-dark text-caption text-italic"},Qe={__name:"redeployment",setup(J){const _=te(),x=ue(),N=pe(),{openWindow:k}=Ne();be();const{getSelectedProject:b,getSelectedOffice:m}=G(N),{capitalize:M}=ie,T=c(m.value?m.value[8]:null),E=c(b.value?b.value[3]:null),R=c(),$=c([]),w=c(""),h=c(""),g=c(!1),f=c({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});S(m,()=>{T.value=m.value?m.value[8]:null}),S(b,()=>{E.value=b.value?b.value[3]:null}),S(h,()=>{C()});const I=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${V(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),q=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${V(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),V=e=>{const o=e.split(" ");let a="";return o.forEach((l,d)=>{a+=d>0?` ${M(l.toLowerCase())}`:M(l.toLowerCase())}),a},Q=({page:e,pageSize:o,descending:a,filter:l,sortBy:d})=>{try{let r="";const v=l&&l!=="";v&&(r=l.trim());const s={$or:[{fullName:{$containsi:`${r}`}},{classification:{$containsi:`${r}`}},{jobNumber:{$containsi:`${r}`}},{workdayId:{$containsi:`${r}`}},{phoneNumber:{$containsi:`${r}`}},{payrollId:{$containsi:`${r}`}}]},n={$and:[...v?[s]:[],{status:{$in:["Pending","Reviewed"]}},{primaryReason:{$eq:"Involuntary"}},{workdayStatus:{$eq:"Active"}},{reason:{$in:["Lack of Work / End of Contract/Project","RIF/Elimination of Position","Project Cancelled Before Employee Started"]}},...h.value?[{effectiveDate:{$eq:h.value}}]:[]]};return ve.getReleases({pagination:{page:e,pageSize:o},sort:`${d||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:n}).then(p=>{const{data:Y,meta:F}=p;return g.value=!1,{data:Y,meta:F}})}catch(r){console.log(r),g.value=!1}},U=async e=>{const{page:o,rowsPerPage:a,sortBy:l,descending:d}=e.pagination,r=e.filter,v=a===0?f.value.rowsNumber:a;g.value=!0;const s=await Q({page:o,sortBy:l,descending:d,pageSize:v,filter:r});if(g.value=!1,s){const{data:n,meta:p}=s;$.value.splice(0,$.value.length,...n),f.value.page=p.pagination.page,f.value.sortBy=l,f.value.descending=d,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsNumber=p.pagination.total}};oe(()=>{R.value.requestServerInteraction()});const C=()=>{R.value.requestServerInteraction()};function D(e,o,a){let l=o!==void 0?o(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const L=async()=>{const{page:e,rowsNumber:o,sortBy:a,descending:l}=f.value,d=await Q({page:e,sortBy:a,descending:l,pageSize:o,filter:w.value});let r=[I.value.map(s=>D(s.label))].concat($.value.map(s=>I.value.map(n=>D(typeof n.field=="function"?n.field(s):s[n.field===void 0?n.name:n.field],n.format,s)).join(","))).join(`\r
`);d&&d.data&&(r=[q.value.map(s=>D(s.label))].concat(d.data.map(s=>q.value.map(n=>D(typeof n.field=="function"?n.field(s):s[n.field===void 0?n.name:n.field],n.format,s)).join(","))).join(`\r
`)),me(`${y().format("MM.DD.YYYY")} Releases-Export.csv`,r,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function W(e){const o=_.resolve({name:"view-release",params:{release:e.id}});k(null,{url:o.href,name:"View Release"})}return(e,o)=>(z(),se("div",null,[t(re,{flat:""},{default:i(()=>[t(ne,null,{default:i(()=>[u("div",Ie,[u("div",Ye,[t(ke,{debounce:"300",dense:""})]),u("div",Ce,[t(H,{dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=a=>w.value=a),label:"Search"},null,8,["modelValue"])]),u("div",Se,[t(H,{dense:"",debounce:"300",modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=a=>h.value=a),label:"Release Date",type:"date","stack-label":""},null,8,["modelValue"])]),Pe])]),_:1})]),_:1}),u("div",null,[t(ce,{title:"Available for Redeployment","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:R,columns:I.value,rows:$.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:f.value,"onUpdate:pagination":o[2]||(o[2]=a=>f.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"","binary-state-sort":"",filter:w.value,onRequest:U},{"body-cell-action":i(a=>[t(A,{props:a},{default:i(()=>[t(j,{class:"cursor-pointer",size:B(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>W(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":i(a=>[t(A,{props:a},{default:i(()=>[u("span",null,P(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":i(({message:a})=>[u("div",qe,[t(j,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),u("span",null,P(a),1)])]),"top-right":i(()=>[u("div",Ve,"(Total: "+P(f.value.rowsNumber)+" releases)",1),t(O,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:C}),t(O,{dense:B(x).screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:L,disable:f.value.rowsNumber<1},null,8,["dense","disable"])]),loading:i(()=>[t(de,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},je={class:"row items-center"},Me={class:"col-12 col-md-4 q-px-sm"},Te={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},ze={class:"col-12 col-md-5 q-px-sm"},Be={__name:"releases",setup(J){const _=te(),x=ue(),N=pe(),k=be(),{getSelectedProject:b,getSelectedMultiOffice:m}=G(N),{userOffices:M}=G(k),{capitalize:T}=ie,E=c(b.value?b.value[3]:null),R=c(),$=c([]),w=c(""),h=c(""),g=c(!1),f=c({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});S(b,()=>{E.value=b.value?b.value[3]:null}),S(h,()=>{C()}),S(m,()=>{C()}),De(()=>m.value.length<=4?"col-md-4":m.value.length<=6?"col-md-5":m.value.length<=8?"col-md-6":m.value.length<=10?"col-md-7":m.value.length<=12?"col-md-8":m.value.length<=14?"col-md-9":m.value.length<=16?"col-md-10":"col-md-4");const I=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${V(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),q=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${V(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),V=e=>{const o=e.split(" ");let a="";return o.forEach((l,d)=>{a+=d>0?` ${T(l.toLowerCase())}`:T(l.toLowerCase())}),a},Q=({page:e,pageSize:o,descending:a,filter:l,sortBy:d})=>{try{let r="";const v=l&&l!=="";v&&(r=l.trim());const s=[];m.value.length>0?m.value.forEach(Y=>{s.push(Y[8])}):M.value("read").forEach(Y=>{s.push(Y[8])});const n={$or:[{fullName:{$containsi:`${r}`}},{classification:{$containsi:`${r}`}},{jobNumber:{$containsi:`${r}`}},{workdayId:{$containsi:`${r}`}},{phoneNumber:{$containsi:`${r}`}},{payrollId:{$containsi:`${r}`}}]},p={$and:[...v?[n]:[],...s.length>0?[{officeRID:{$in:s}}]:[],...h.value?[{effectiveDate:{$eq:h.value}}]:[]]};return ve.getReleases({pagination:{page:e,pageSize:o},sort:`${d||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:p}).then(Y=>{const{data:F,meta:ge}=Y;return g.value=!1,{data:F,meta:ge}})}catch(r){console.log(r),g.value=!1}},U=async e=>{const{page:o,rowsPerPage:a,sortBy:l,descending:d}=e.pagination,r=e.filter,v=a===0?f.value.rowsNumber:a;g.value=!0;const s=await Q({page:o,sortBy:l,descending:d,pageSize:v,filter:r});if(g.value=!1,s){const{data:n,meta:p}=s;$.value.splice(0,$.value.length,...n),f.value.page=p.pagination.page,f.value.sortBy=l,f.value.descending=d,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsPerPage=p.pagination.pageSize,f.value.rowsNumber=p.pagination.total}};oe(()=>{Z(()=>{R.value.requestServerInteraction()})});const C=()=>{Z(()=>{R.value.requestServerInteraction()})};function D(e,o,a){let l=o!==void 0?o(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const L=async()=>{const{page:e,rowsNumber:o,sortBy:a,descending:l}=f.value,d=await Q({page:e,sortBy:a,descending:l,pageSize:o,filter:w.value});let r=[I.value.map(s=>D(s.label))].concat($.value.map(s=>I.value.map(n=>D(typeof n.field=="function"?n.field(s):s[n.field===void 0?n.name:n.field],n.format,s)).join(","))).join(`\r
`);d&&d.data&&(r=[q.value.map(s=>D(s.label))].concat(d.data.map(s=>q.value.map(n=>D(typeof n.field=="function"?n.field(s):s[n.field===void 0?n.name:n.field],n.format,s)).join(","))).join(`\r
`)),me(`${y().format("MM.DD.YYYY")} Releases-Export.csv`,r,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function W(e){_.push({name:"view-release",params:{release:e.id}})}return(e,o)=>(z(),se("div",null,[t(re,{flat:""},{default:i(()=>[t(ne,null,{default:i(()=>[u("div",je,[t(ae),u("div",Me,[t(Re)])])]),_:1})]),_:1}),u("div",null,[t(ce,{title:"Releases","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:R,columns:I.value,rows:$.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:f.value,"onUpdate:pagination":o[2]||(o[2]=a=>f.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"",separator:"horizontal",color:"accent","binary-state-sort":"",filter:w.value,onRequest:U},{"body-cell-action":i(a=>[t(A,{props:a},{default:i(()=>[t(j,{class:"cursor-pointer",size:B(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>W(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":i(a=>[t(A,{props:a},{default:i(()=>[u("span",null,P(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":i(({message:a})=>[u("div",Te,[t(j,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),u("span",null,P(a),1)])]),top:i(()=>[u("div",ze,[t(H,{dense:"",modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=a=>w.value=a),label:"Search...",clearable:""},{prepend:i(()=>[t(j,{name:"search"})]),_:1},8,["modelValue"])]),t(ae),u("div",{class:_e(["text-dark text-caption text-italic",B(x).screen.lt.md?"offset-xs-5":""])},"(Total: "+P(f.value.rowsNumber)+" releases)",3),f.value.rowsNumber<=1e3?(z(),fe(O,{key:0,flat:"",round:"",color:"primary",icon:"download",disable:f.value.rowsNumber<1,onClick:L},{default:i(()=>[t(le,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:i(()=>[ee(" Download ")]),_:1})]),_:1},8,["disable"])):xe("",!0),t(O,{flat:"",round:"",color:"primary",icon:"refresh",onClick:o[1]||(o[1]=a=>C(!0)),loading:g.value},{default:i(()=>[t(le,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:i(()=>[ee(" Refresh ")]),_:1})]),_:1},8,["loading"])]),loading:i(()=>[t(de,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},Oe={class:"q-pa-md"},wa={__name:"index",setup(J){const _=c(0);return(x,N)=>(z(),fe(he,{style:{"max-width":"100vw"}},{default:i(()=>[u("div",Oe,[t(we,{class:"bg-info text-white shadow-2 rounded-borders"},{default:i(()=>[t($e,{modelValue:_.value,"onUpdate:modelValue":N[0]||(N[0]=k=>_.value=k),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:i(()=>[t(K,{name:0,label:"Available for Redeployment"}),t(K,{name:1,label:"Releases"})]),_:1},8,["modelValue"])]),_:1}),t(ye,{modelValue:_.value,"onUpdate:modelValue":N[1]||(N[1]=k=>_.value=k),animated:""},{default:i(()=>[t(X,{name:0},{default:i(()=>[t(Qe)]),_:1}),t(X,{name:1},{default:i(()=>[t(Be)]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{wa as default};
