import{a as Ae,Q as O}from"./QStep.821b9b4d.js";import{Q as Ne}from"./QPage.6f4063c4.js";import{l as B,r as T,bT as ee,c as k,_ as z,y as n,z as p,d as l,aq as P,ap as S,bq as c,cU as M,B as h,D as j,cW as G,bV as V,F as L,b3 as U,ab as F,bs as Pe,bQ as _e,bO as oe,aw as Ye,bP as Se,de as Xe,cT as x,b4 as H,E as Te,v as de,bS as Ve,w as Qe,dj as Fe,bR as ce,bN as Ie,cV as re,cz as Me}from"./index.b35eeed3.js";import{q as N,c as Le}from"./app.31ce29fc.js";import{u as W}from"./dataStore.54140746.js";import{Q as ae}from"./QInnerLoading.832dc14e.js";import{Q as He}from"./QRating.5568d0a4.js";import{Q as Oe}from"./QList.5b498127.js";import{u as X,c as je}from"./useQuerySaver.d29ff9ee.js";import{dayjs as q}from"./dayjs.c324749c.js";import{Q as ne,a as Be,b as ie}from"./QTabPanels.b3c7c119.js";import{Q as ze}from"./QTabs.0e7a4c01.js";import{Q as Ue}from"./QForm.6c8993a8.js";import{u as Ge}from"./use-quasar.6afddd70.js";import"./index.04bc0a32.js";import{u as We}from"./index.2d1de515.js";import{a as Je,u as te}from"./vee-validate.esm.0c700e69.js";import{a as Ke,b as Ze,c as xe}from"./array.164cfe36.js";import{Q as ea}from"./QSpinnerBall.2bf8c720.js";import{E as aa}from"./form-edit-card-section.3e1ea013.js";import{H as ta}from"./historyPanel.b630a357.js";import{Q as la}from"./QTable.c08ed117.js";import"./use-panel.87525cc8.js";import"./touch.3df10340.js";import"./selection.423f1a2d.js";import"./QSlideTransition.5a4a5d45.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.504e0e11.js";import"./i18n.a721d321.js";import"./QResizeObserver.e8b5d41e.js";import"./rtl.b51694b1.js";import"./QSelect.2ba35ed2.js";import"./QChip.86c715a9.js";import"./QMenu.fc0510b6.js";import"./position-engine.301e00c6.js";import"./QTr.47ac074f.js";import"./QTd.a7c86421.js";import"./QMarkupTable.39675ceb.js";import"./use-fullscreen.36eb3617.js";const sa=B({props:{id:Number},components:{},setup(a){const s=T(!1),m=ee(),{getEmployee:v,updateViewedEmployees:g,setReleases:E}=W(),o=k(()=>m.params.id?m.params.id:null),t=k(()=>o.value?v(o.value):null),u=k(()=>t.value&&t.value.release?t.value.release:null),d=k(()=>{let w;return u.value&&u.value[3]?w=[{label:"Project",value:u.value[46]},{label:"Job Title",value:u.value[82]},{label:"Reason",value:u.value[32]},{label:"Last Day On Site",value:q(u.value[36].$d).format("MM/DD/YYYY")},{label:"CAAP Rating",value:u.value[59]&&u.value[59].length>0?u.value[59][0][37]:0,type:"rating"},{label:"Submitted On",value:q(u.value[1].$d).tz(q.tz.guess()).format("MM/DD/YYYY hh:mm a")},{label:"Comments",value:u.value[60],type:"comments"}]:w=[],w}),b=async w=>{if(w||!u.value&&a.id){s.value=!0;const{data:r}=await N.fetchFromHiringApp({fields:[X({type:"releases",id:a.id})]});console.log(r),g({id:o.value,dataset:"release",data:r}),E({id:a.id,data:r}),s.value=!1}};return b(),{loading:s,release:u,loadData:b,releaseDetails:d}}}),oa={key:0,class:"q-py-xl"},ra={class:"row items-start"},na=h("div",{class:"col-12 col-md-8"},[h("div",{class:"text-primary text-h6"},"This Employee Has a Pending Release")],-1),ia={class:"row"},ua={class:"col-12 col-md-3"},da={class:"text-body2"},ca={class:"col-12 col-md-9"},ma={key:0},fa={key:1,class:"text-body2 text-weight-light"},pa={key:1,class:"text-body2 text-weight-light"},va={class:"text-body1 text-weight-bold q-mb-xs"},ba={class:"text-body2 text-italic text-primary q-pl-md"},ga=h("div",{class:"text-body1 text-weight-bold q-mb-xs"},"Supporting Docs",-1);function ya(a,s,m,v,g,E){return n(),p("div",null,[a.loading?(n(),p("div",oa,[l(ae,{color:"info",showing:a.loading,"label-class":"text-info",label:"Loading Release..."},null,8,["showing"])])):P("",!0),a.release&&!a.loading?(n(),S(x,{key:1},{default:c(()=>[l(M,null,{default:c(()=>[h("div",ra,[na,h("div",{class:j(["col-12 col-md-4",a.$q.screen.lt.md?"order-first":""])},[l(G,{class:"q-pa-none",align:"right"},{default:c(()=>[l(V,{flat:"",color:"secondary",label:"Refresh",icon:"refresh",onClick:s[0]||(s[0]=o=>a.loadData(!0))}),l(V,{size:"md",flat:"",dense:"",label:"View Release",color:"info",to:{name:"view-ee-release",params:{id:a.release[25],release:a.release[3]}}},null,8,["to"])]),_:1})],2)])]),_:1}),(n(!0),p(L,null,U(a.releaseDetails,o=>(n(),p(L,{key:o},[o.type!=="comments"?(n(),S(M,{key:0,class:"q-py-sm"},{default:c(()=>[h("div",ia,[h("div",ua,[h("div",da,F(o.label),1)]),h("div",ca,[o.type==="rating"?(n(),p("div",ma,[o.value>0?(n(),S(He,{key:0,modelValue:o.value,"onUpdate:modelValue":t=>o.value=t,max:"5",size:"sm",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(n(),p("div",fa,"Not Available"))])):(n(),p("div",pa,F(o.value),1))])])]),_:2},1024)):o.value!==""?(n(),S(M,{key:1},{default:c(()=>[h("div",va,F(o.label),1),h("div",ba,F(o.value),1)]),_:2},1024)):P("",!0)],64))),128)),a.release&&a.release[70].length>0?(n(),S(M,{key:0},{default:c(()=>[ga,l(Oe,null,{default:c(()=>[(n(!0),p(L,null,U(a.release[70],(o,t)=>Pe((n(),S(_e,{key:t,clickable:"",class:"text-body2",onClick:u=>a.downloadFile({tableId:"bsstsai5d",recordId:o[3],fieldId:6,versionNumber:1,name:o[7]})},{default:c(()=>[l(oe,null,{default:c(()=>[Ye(F(t+1)+". "+F(o[7]),1)]),_:2},1024),l(oe,{avatar:""},{default:c(()=>[l(Se,{color:"info",name:"file_download"})]),_:1})]),_:2},1032,["onClick"])),[[Xe]])),128))]),_:1})]),_:1})):P("",!0)]),_:1})):P("",!0)])}var ha=z(sa,[["render",ya]]);const $a=B({props:{},setup(a){const s=T(!1),m=ee(),{getEmployee:v,updateViewedEmployees:g,setReleases:E}=W(),o=k(()=>m.params.id?m.params.id:null),t=k(()=>o.value?v(o.value):null),u=k(()=>t.value?t.value[79]===4?"inprocess":t.value[79]===5?"dispatch":null:null),d=k(()=>u.value&&t.value[u.value]?t.value[u.value]:null),b=async w=>{let r;if(t.value?t.value[79]===4&&t.value[145]?r=[X({type:"rawInProcesses",id:t.value[145]})]:t.value[79]===5&&t.value[175]?r=[X({type:"dispatches",id:t.value[175]})]:r=null:r=null,r&&u.value&&(w||!d.value)){s.value=!0;const{data:i}=await N.fetchFromHiringApp({fields:r});console.log(i),g({id:o.value,dataset:u.value,data:i}),s.value=!1}};return b(),{loading:s,processingData:d,loadData:b}}}),wa={key:0,class:"q-py-xl"};function Ca(a,s,m,v,g,E){return n(),p("div",null,[a.loading?(n(),p("div",wa,[l(ae,{color:"info",showing:a.loading,"label-class":"text-info",label:"Loading Release..."},null,8,["showing"])])):P("",!0),a.processingData&&!a.loading?(n(),S(x,{key:1,flat:""},{default:c(()=>[l(G,{class:"q-pa-none",align:"right"},{default:c(()=>[l(V,{flat:"",color:"secondary",label:"Refresh",icon:"refresh",onClick:s[0]||(s[0]=o=>a.loadData(!0))})]),_:1}),l(M),l(G,{class:"q-pa-none",align:"right"},{default:c(()=>[l(V,{color:"secondary",label:"Back"}),l(V,{color:"info",label:"Continue"})]),_:1})]),_:1})):P("",!0)])}var Da=z($a,[["render",Ca]]);const ka=a=>{const s=[];for(const[m,v]of Object.entries(a)){const g={fid:m,value:v};s.push(g)}return{props:s}},ue=async({employee:a,profile:s,hiring:m,employment:v})=>{const{data:g}=await N.upsertRecordsXML({to:"bp3gb7ng2",data:[{3:{value:a[3]},79:{value:m||a[79]},122:{value:s||a[122]},408:{value:v||a[408]}}],fieldsToReturn:[79,122,408,80,81,582,583,584]});return ka(g[0]),{res:a}},qa=B({emits:[],props:{item:Object},components:{EditDetailsForm:aa},setup(a,{emit:s}){const m=T(!1),v=T(!1),g=k(()=>{const{permission:t}=a.item.editable&&a.item.config?a.item.config:{action:null,subject:null};return t}),E=k(()=>{const{getter:t,formatter:u}=a.item.config;if(t){const d=t();return d?u?u(d):d:null}else return null}),o=async t=>{m.value=!0;const{fetcher:u}=a.item.config;u&&(!E.value||t)&&await u(),m.value=!1};return a.item.config&&o(),{edit:v,permission:g,loadData:o,loading:m,data:E}}}),Ea={key:0},Ra={key:1};function Aa(a,s,m,v,g,E){const o=H("edit-details-form");return n(),p("div",Te(a.$attrs,{class:a.$attrs.class||"q-pa-sm"}),[a.edit?(n(),S(o,{key:1,type:a.item.label,config:a.item.config,onCancelEdit:s[1]||(s[1]=t=>a.edit=!1)},null,8,["type","config"])):(n(),p("div",Ea,[a.item.editable&&a.$can(a.permission.action,a.permission.subject)?(n(),S(V,{key:0,color:a.item.buttonColor||"accent",flat:"",dense:"",round:"",icon:"edit",size:"sm",onClick:s[0]||(s[0]=t=>a.edit=!0)},null,8,["color"])):P("",!0),h("div",{class:j(a.$attrs.labelClass||["text-weight-bold text-info",a.$q.screen.gt.lg?"text-body2":"text-caption"])},F(a.item.label),3),a.item.hasFetch?(n(),p("div",{key:2,class:j(a.$attrs.valueClass||["q-pl-sm text-weight-light",a.$q.screen.gt.lg?"text-body2":"text-caption"])},[a.loading?(n(),p("div",{key:0,class:j(["text-dark q-mr-sm",a.$q.screen.gt.lg?"text-body2":"text-caption"])},[l(ea,{class:"q-ml-sm",color:"primary",size:a.$q.screen.gt.lg?"3em":"2em"},null,8,["size"])],2)):(n(),p("span",Ra,F(a.data||a.item.valueIfNull),1))],2)):(n(),p("div",{key:1,class:j([a.item.valueClass||"","q-pl-sm text-weight-light",a.$q.screen.gt.lg?"text-body2":"text-caption"])},F(a.item.value===""?"N/A":a.item.value),3))]))],16)}var me=z(qa,[["render",Aa]]);const Na=B({emits:["nameRequestConfirmed","nameRequestNotConfirmed"],props:{employee:Object},components:{},setup(a,{emit:s}){const m=T(!1),v=T([]),{capitalize:g}=de,{updateViewedEmployees:E,getEmployee:o}=W(),t=k(()=>a.employee?o(a.employee[3]):null),u=k(()=>t.value&&t.value.nameRequests?t.value.nameRequests:[]),d=i=>{const R=i.split(" ");let _="";return R.forEach((Q,J)=>{_+=J>0?` ${g(Q.toLowerCase())}`:g(Q.toLowerCase())}),_},b=[{name:0,label:"Date",align:"left",field:i=>i[1].$d,format:i=>`${q(i).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"First Name",align:"left",field:i=>i[6],format:(i,R)=>`${d(`${i} ${R[7]}`)}`,sortable:!0},{name:2,label:"Last 4",align:"left",field:i=>i[16],format:i=>`${i}`,sortable:!0},{name:3,label:"Phone",align:"left",field:i=>i[8],format:i=>`${i}`,sortable:!0},{name:4,label:"Project",align:"left",field:i=>i[41],format:i=>`${i}`,sortable:!0},{name:5,label:"Classification",align:"left",field:i=>i[24],format:i=>`${i}`,sortable:!0},{name:6,label:"Rate",align:"left",field:i=>i[25],format:i=>`$ ${i.toFixed(2)}`,sortable:!0}],w=async i=>{if(t.value&&(i||u.value.length===0)){m.value=!0;const{data:R}=await N.fetchFromHiringApp({fields:[X({type:"nameByEmployee",query:`{'1'.IR.'last 14 d'}AND{'31'.XEX.'Closed'}AND{'31'.XEX.'Cancelled'}AND({'39'.EX.'${t.value[3]}'}OR({'16'.EX.'${t.value[188].slice(-4)}'}AND{'29'.EX.'${t.value[27]}'}))`})]}),_=R.length>0?R.sort((Q,J)=>Q[1].$d>J[1].$d?-1:1):[];E({id:t.value[3],dataset:"nameRequests",data:_}),m.value=!1}},r=async({rows:i,added:R})=>{if(R){const _=i[0],{data:Q}=await N.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:_[3]},10:{value:"Arrived at Hiring Center"},39:{value:t.value[3]}}],fieldsToReturn:[40],formatObject:40});E({id:t.value[3],dataset:"confirmedNameRequest",data:Q[0][40]}),s("nameRequestConfirmed",Q[0][40])}else{const _=i[0],{data:Q}=await N.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:_[3]},10:{value:"Has Not Arrived"},39:{value:""}}],fieldsToReturn:[40],formatObject:40});E({id:t.value[3],dataset:"confirmedNameRequest",data:{}}),s("nameRequestNotConfirmed",Q[0][40])}};return w(),{columns:b,nameData:u,loading:m,selected:v,updateName:r,initialPagination:{rowsPerPage:T(10)},properValue:d}}}),Pa=h("div",null,[h("div",{class:"text-body1 text-primary"},"Possible Name Requests"),h("div",{class:"text-caption text-dark text-italic"},"Check the box to confirm match to employee.")],-1);function _a(a,s,m,v,g,E){return n(),p("div",null,[!a.loading&&a.nameData.length>0?(n(),S(la,{key:0,flat:"",dense:"",title:"Possible Name Requests",columns:a.columns,rows:a.nameData,"row-key":o=>o[3],"table-header-class":"bg-dark text-white",class:"sticky-header-table",pagination:a.initialPagination,loading:a.loading,"no-data-label":"No possible name requests",selection:"single",selected:a.selected,"onUpdate:selected":s[0]||(s[0]=o=>a.selected=o),onSelection:a.updateName,"hide-pagination":a.nameData.length<=10},{"top-left":c(()=>[Pa]),_:1},8,["columns","rows","row-key","pagination","loading","selected","onSelection","hide-pagination"])):P("",!0)])}var Ya=z(Na,[["render",_a]]);const Sa=B({props:{},components:{FieldAndLabelEditable:me,HistoryPanel:ta,NameRequestLookup:Ya},setup(a){const s=T(!1),m=Ge(),v=T(!1),g=T(!1),E=T(0),o=T(!1),t=ee(),u=Ve(),{can:d}=We(),{capitalize:b}=de,{getEmployee:w,updateViewedEmployees:r,setEmployees:i}=W(),{getProfiles:R}=Le(),_=async({interview:y,sch:e})=>{e&&(s.value=!0)},Q=async()=>{R(Y.value[16]).filter(e=>e[3]!==Y.value[3]),m.dialog({title:"Confirm",message:"Are you sure you ready to start interview now?",persistent:!0,cancel:!0}).onOk(async()=>{const{data:e}=await N.upsertRecordsXML({to:"bp3gatnch",data:[{10:{value:Y.value[3]},11:{value:Y.value[16]},20:{value:"In Progress"}}],fieldsToReturn:[97],formatObject:97});r({id:Y.value[3],dataset:"interview",data:e}),ue({employee:Y.value,profile:9,hiring:3})})},J=()=>{R(Y.value[16]).filter(e=>e[3]!==Y.value[3]),m.dialog({title:"Confirm",message:"Are you sure you want to remove?",persistent:!0,cancel:!0}).onOk(async()=>{ue({employee:Y.value,profile:9,hiring:8})})},fe=Ke({scheduleDate:Ze().required().label("Date"),scheduleTime:xe().required().label("Time")}),{errors:pe,handleSubmit:ve}=Je({validationSchema:fe}),{value:be}=te("scheduleDate"),{value:ge}=te("scheduleTime"),{value:ye}=te("location"),he=ve(async y=>{console.log(y)}),$e=y=>{const e=[];for(const[f,D]of Object.entries(y)){const A={fid:f,value:D};e.push(A)}r({id:$.value,props:e})},we=({start:y,end:e,status:f})=>f==="In Process"?"TBD":f==="DNC"?"N/A":f==="Complete"&&y&&e?`${q(e).diff(q(y),"day",!0).toFixed(2)} days`:"N/A",le=y=>y[145].$d?y[145].$d:y[1].$d,Ce=y=>{if(!y||!y[0]||!y[0][44])return"N/A";{const e=y[0][44];return`${b(e[20].toLowerCase())} ${b(e[22].toLowerCase())}`}},De=y=>{const e=y.split(" ");let f="";return e.forEach((D,A)=>{f+=A>0?` ${b(D.toLowerCase())}`:b(D.toLowerCase())}),f},$=k(()=>t.params.id?t.params.id:null),Y=k(()=>$.value?w($.value):null),C=k(()=>Y.value),ke=k(()=>{let y;return C.value?y=[{label:"Phone",value:C.value[25],colClass:"col-md-4"},{label:"Address",value:De(C.value[40]),colClass:"col-md-8"},{label:"Work Experience",value:C.value[54],colClass:"col-md-4"},{label:"Employment Status",value:C.value[56],colClass:"col-md-6"},{label:"Primary Craft",value:C.value[52],colClass:"col-md-4"},{label:`${C.value[52]} Test Score`,value:C.value[52],colClass:"col-md-4",hide:!C.value[585],hasFetch:C.value[585],valueIfNull:`No ${C.value[52]} Tests`,config:{fetcher:async()=>{const{data:e}=await N.fetchFromHiringApp({fields:[X({type:"craftTests",query:`{'37'.EX.'Complete'}AND{'15'.EX.'${$.value}'}`})]});e.sort((D,A)=>D[1].$d>A[1].$d?-1:1).length>0&&r({id:$.value,dataset:"history",nested:!0,subset:"craftTests",data:e})},getter:()=>{let e=w($.value)&&w($.value).history?w($.value).history.craftTests:null;return e?(e=e.filter(f=>f[17]===Y.value[51]),e.length>0?e[0]:null):null},formatter:e=>e[71]}},{label:`${C.value[52]} Practical Score`,value:C.value[52],colClass:"col-md-4",hide:!C.value[586],hasFetch:C.value[586],valueIfNull:`No ${C.value[52]} Practicals`,config:{fetcher:async()=>{const{data:e}=await N.fetchFromHiringApp({fields:[X({type:"bestPracticals",query:`{'6'.EX.'Complete'}AND{'13'.EX.'${$.value}'}`})]});e.sort((D,A)=>D[1].$d>A[1].$d?-1:1).length>0&&r({id:$.value,dataset:"history",nested:!0,subset:"bestPracticals",data:e})},getter:()=>{let e=w($.value)&&w($.value).history?w($.value).history.bestPracticals:null;return e?(e=e.filter(f=>f[51]===Y.value[51]),e.length>0?e[0]:null):null},formatter:e=>e[55]}}]:y=[],y}),qe=k(()=>[{label:"Craft Tests",key:"craftTests",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[44],format:e=>`${e}`,sortable:!0},{name:2,label:"Craft",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!0},{name:3,label:"Score",align:"left",field:e=>e[71],format:e=>`${e}`,sortable:!0}],getter:async()=>{const{data:e}=await N.fetchFromHiringApp({fields:[X({type:"craftTests",query:`{'15'.EX.'${$.value}'}AND{'37'.EX.'Complete'}`})]});r({id:$.value,dataset:"history",nested:!0,subset:"craftTests",data:e})}},{label:"Practicals",key:"bestPracticals",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[17],format:e=>`${e}`,sortable:!0},{name:2,label:"Craft",align:"left",field:e=>e[52],format:e=>`${e}`,sortable:!0},{name:3,label:"Score",align:"left",field:e=>e[55],format:e=>`${e}`,sortable:!0}],getter:async()=>{const{data:e}=await N.fetchFromHiringApp({fields:[X({type:"bestPracticals",query:`{'6'.EX.'Complete'}AND{'13'.EX.'${$.value}'}`})]});r({id:$.value,dataset:"history",nested:!0,subset:"bestPracticals",data:e})}},{label:"Offers",key:"offers",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[44],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[56],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[57],format:e=>`${e}`,sortable:!0},{name:4,label:"Rate",align:"left",field:e=>e[22],format:e=>`$ ${e.toFixed(2)}`,sortable:!0,hide:!d("read","rates")},{name:5,label:"Status",align:"left",field:e=>e[21],format:e=>`${e}`,sortable:!0}],getter:async()=>{const{data:e}=await N.fetchFromHiringApp({fields:[X({type:"offers",query:`{'25'.EX.'${$.value}'}AND{'21'.XEX.'Canceled'}AND{'29'.XEX.'In Process'}AND{'29'.XEX.'Canceled'}`})]});r({id:$.value,dataset:"history",nested:!0,subset:"offers",data:e})},showCompletion:!0,completionRateOverride:"Acceptance Rate",completionRate:e=>(e.filter(A=>A[21]==="Accepted").length/e.length*100).toFixed(2)},{label:"Assignments",key:"assignments",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[23],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[94],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[20],format:e=>`${e}`,sortable:!0},{name:4,label:"Time On Site",align:"left",field:e=>e[22],format:(e,f)=>we({start:le(f),end:e.$d,status:f[21]}),sortable:!1}],getter:async()=>{const{data:e}=await N.fetchFromHiringApp({fields:[X({type:"rawAssignments",query:`{'18'.EX.'${$.value}'}AND{'21'.XEX.'Canceled'}`})]});r({id:$.value,dataset:"history",nested:!0,subset:"assignments",data:e})},showCompletion:!0,completionRate:e=>(e.filter(A=>A[21]==="Complete").length/e.length*100).toFixed(2),showDuration:!0,averageDuration:e=>{const f=e.filter(I=>I[21]==="Complete");let D=0;f.forEach(I=>{const K=le(I),Z=I[22].$d;K&&Z&&(D+=q(Z).diff(q(K),"ms",!0))});const A=D/f.length;return q.duration(A).asDays()}},{label:"Releases",key:"releases",columns:[{name:0,label:"Date",align:"left",field:e=>e[36].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Project",align:"left",field:e=>e[83],format:e=>`${e}`,sortable:!0},{name:2,label:"Classification",align:"left",field:e=>e[48],format:e=>`${e}`,sortable:!0},{name:3,label:"Rating",align:"left",field:e=>e[59],format:e=>e[0]&&e[0][37]?e[0][37]:"N/A",sortable:!1,showRating:!0},{name:4,label:"Disposition",align:"left",field:e=>e[43],format:e=>`${e}`,sortable:!0},{name:5,label:"Evaluated By",align:"left",field:e=>e[59],format:(e,f)=>e?`${Ce(e)}`:"N/A",sortable:!1},{name:6,label:"Reviewed By",align:"left",field:e=>e[75],format:(e,f)=>e?`${b(e[35].toLowerCase())} ${b(e[37].toLowerCase())}`:"N/A",sortable:!1},{name:7,label:"Processed By",align:"left",field:e=>e[76],format:(e,f)=>e?`${b(e[35].toLowerCase())} ${b(e[37].toLowerCase())}`:"N/A",sortable:!1}],getter:async()=>{const{data:e}=await N.fetchFromHiringApp({fields:[X({type:"releases",query:`{'25'.EX.'${$.value}'}`})]});r({id:$.value,dataset:"history",nested:!0,subset:"releases",data:e})},showCompletion:!0,completionRateOverride:"Reassignment Rate",completionRate:e=>(e.filter(A=>A[43]==="Reassign").length/e.length*100).toFixed(2),showRating:!0,averageRating:e=>e.filter(D=>D[59]&&D[59][0]&&D[59][0][37]).reduce((D,A)=>D+A[59][0][37],0),showView:!0,viewer:e=>{u.push({name:"view-ee-release",params:{id:e[25],release:e[3]}})}},{label:"Other Experience",key:"workExperience",columns:[{name:0,label:"Date Entered",align:"left",field:e=>e[1].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Start Date",align:"left",field:e=>e[12].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:2,label:"End Date",align:"left",field:e=>e[13].$d,format:e=>`${q(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:3,label:"Company",align:"left",field:e=>e[7],format:e=>`${e}`,sortable:!0},{name:4,label:"Location",align:"left",field:e=>e[10],format:e=>`${e}`,sortable:!0},{name:5,label:"Classification",align:"left",field:e=>e[11],format:e=>`${e}`,sortable:!0}],getter:async()=>{const{data:e}=await N.fetchFromRecruitingApp({fields:[je({type:"workExperience",query:Y.value&&Y.value[234]?`{'32'.EX.'false'}AND{'8'.EX.'${Y.value[234]}'}`:`{'32'.EX.'false'}AND{'34'.EX.'${$.value}'}`})]});r({id:$.value,dataset:"history",nested:!0,subset:"workExperience",data:e})},showDuration:!0,averageDuration:e=>{const f=e.filter(I=>I[12].$d&&I[13].$d);let D=0;f.forEach(I=>{const K=I[12].$d,Z=I[13].$d;K&&Z&&(D+=q(Z).diff(q(K),"ms",!0))});const A=D/f.length;return q.duration(A).asDays()}}]),se=()=>{C.value&&(g.value=C.value[247])};Qe(C,()=>{C.value&&C.value[247]!==g.value&&(g.value=C.value[247])});const Ee=async(y,e)=>{try{const{data:f}=await N.upsertRecordsXML({to:"bp3gb7ng2",data:[{3:{value:$.value},247:{value:y}}],fieldsToReturn:[247]});$e({247:y})}catch{m.notify({type:"negative",message:"Error updating Bootcamp Graduate"})}};return se(),{loading:o,loadData:se,details:ke,data:C,employee:Y,splitterModel:T(15),tab:E,vertical:v,bootcamp:g,updateBootcamp:Ee,panels:qe,schedule:s,scheduleDate:be,scheduleTime:ge,location:ye,submit:he,formErrors:pe,proceed:_,removeFromProfiles:J,startInterview:Q}}}),Xa={key:0,class:"q-py-xl"},Ta={key:1},Va={class:"q-pa-none"},Qa={class:"row"},Fa={class:"row q-py-sm"},Ia={class:"col-12"},Ma=h("div",{class:"text-h6 text-info"},"Schedule Interview",-1),La={class:"text-caption"},Ha={class:"text-caption"};function Oa(a,s,m,v,g,E){const o=H("field-and-label-editable"),t=H("name-request-lookup"),u=H("history-panel");return n(),p("div",null,[a.loading?(n(),p("div",Xa,[l(ae,{color:"info",showing:a.loading,"label-class":"text-info",label:"Loading..."},null,8,["showing"])])):P("",!0),a.data&&!a.loading?(n(),p("div",Ta,[h("div",Va,[l(ze,{class:"q-py-xs bg-info text-white shadow-2 rounded-borders",align:"left",modelValue:a.tab,"onUpdate:modelValue":s[0]||(s[0]=d=>a.tab=d),dense:"","indicator-color":"accent","outside-arrows":"","mobile-arrows":"","inline-label":""},{default:c(()=>[l(ne,{name:0,label:"General"}),(n(!0),p(L,null,U(a.panels,(d,b)=>(n(),S(ne,{key:b,name:b+1,label:d.label},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),l(x,{class:"q-mt-sm"},{default:c(()=>[l(M,{class:"q-pa-none"},{default:c(()=>[l(Be,{modelValue:a.tab,"onUpdate:modelValue":s[3]||(s[3]=d=>a.tab=d),animated:""},{default:c(()=>[l(ie,{class:"q-pa-xs",name:0},{default:c(()=>[h("div",null,[l(Fe,{modelValue:a.bootcamp,"onUpdate:modelValue":[s[1]||(s[1]=d=>a.bootcamp=d),s[2]||(s[2]=(d,b)=>a.updateBootcamp(d))],color:"primary","indeterminate-value":"false",size:"sm",label:"Bootcamp Graduate"},null,8,["modelValue"])]),h("div",Qa,[(n(!0),p(L,null,U(a.details,(d,b)=>(n(),p(L,{key:b},[d.hide?P("",!0):(n(),p("div",{key:0,class:j(["col-12 q-pr-sm",d.colClass||"col-md-6"])},[l(o,{item:d},null,8,["item"])],2))],64))),128))]),h("div",Fa,[h("div",Ia,[l(t,{employee:a.data},null,8,["employee"])])])]),_:1}),(n(!0),p(L,null,U(a.panels,(d,b)=>(n(),S(ie,{key:b,name:b+1},{default:c(()=>[l(u,{category:d},null,8,["category"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(ce),l(G,{align:"right"},{default:c(()=>[l(V,{color:"secondary",label:"Remove from Profiles",onClick:a.removeFromProfiles},null,8,["onClick"]),l(V,{color:"accent",label:"Schedule Interview",onClick:s[4]||(s[4]=d=>a.proceed({sch:!0}))}),l(V,{color:"primary",label:"Start Interview",onClick:a.startInterview},null,8,["onClick"])]),_:1})]),_:1})])])):P("",!0),l(Me,{persistent:"",modelValue:a.schedule,"onUpdate:modelValue":s[8]||(s[8]=d=>a.schedule=d)},{default:c(()=>[l(x,{flat:"",style:{width:"500px"}},{default:c(()=>[l(M,null,{default:c(()=>[Ma]),_:1}),l(M,null,{default:c(()=>[l(Ue,{onSubmit:Ie(a.submit,["prevent"])},{default:c(()=>[l(re,{dense:"",label:"Date",type:"date",modelValue:a.scheduleDate,"onUpdate:modelValue":s[5]||(s[5]=d=>a.scheduleDate=d),"bottom-slots":"","stack-label":"",error:!!a.formErrors.scheduleDate},{error:c(()=>[h("div",La,F(a.formErrors.scheduleDate),1)]),_:1},8,["modelValue","error"]),l(re,{dense:"",label:"Time",type:"time",modelValue:a.scheduleTime,"onUpdate:modelValue":s[6]||(s[6]=d=>a.scheduleTime=d),"bottom-slots":"","stack-label":"",error:!!a.formErrors.scheduleTime},{error:c(()=>[h("div",Ha,F(a.formErrors.scheduleTime),1)]),_:1},8,["modelValue","error"])]),_:1},8,["onSubmit"])]),_:1}),l(G,{class:"q-px-xs",align:"right"},{default:c(()=>[l(V,{color:"secondary",label:"Cancel",onClick:s[7]||(s[7]=d=>a.schedule=!1)}),l(V,{color:"primary",label:"Save",type:"submit",onClick:a.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var ja=z(Sa,[["render",Oa]]);const Ba=B({props:{},components:{FieldAndLabelEditable:me},setup(a){const s=T(!1),m=ee(),{getEmployee:v,updateViewedEmployees:g,setReleases:E}=W(),o=k(()=>m.params.id?m.params.id:null),t=k(()=>o.value?v(o.value):null),u=k(()=>t.value&&t.value.interview?t.value.interview:null),d=k(()=>{let w;return u.value?w=[{label:"Work Experience",value:t.value[54],colClass:"col-md-4"},{label:"Employment Status",value:t.value[56],colClass:"col-md-6"},{label:"Primary Craft",value:t.value[52],colClass:"col-md-4"},{label:`${t.value[52]} Test Score`,value:t.value[52],colClass:"col-md-4",hide:!t.value[585],hasFetch:t.value[585],valueIfNull:`No ${t.value[52]} Tests`,config:{fetcher:async()=>{const{data:r}=await N.fetchFromHiringApp({fields:[X({type:"craftTests",query:`{'37'.EX.'Complete'}AND{'15'.EX.'${o.value}'}`})]});r.sort((R,_)=>R[1].$d>_[1].$d?-1:1).length>0&&g({id:o.value,dataset:"history",nested:!0,subset:"craftTests",data:r})},getter:()=>{let r=v(o.value)&&v(o.value).history?v(o.value).history.craftTests:null;return r?(r=r.filter(i=>i[17]===t.value[51]),r.length>0?r[0]:null):null},formatter:r=>r[71]}},{label:`${t.value[52]} Practical Score`,value:t.value[52],colClass:"col-md-4",hide:!t.value[586],hasFetch:t.value[586],valueIfNull:`No ${t.value[52]} Practicals`,config:{fetcher:async()=>{const{data:r}=await N.fetchFromHiringApp({fields:[X({type:"bestPracticals",query:`{'6'.EX.'Complete'}AND{'13'.EX.'${o.value}'}`})]});r.sort((R,_)=>R[1].$d>_[1].$d?-1:1).length>0&&g({id:o.value,dataset:"history",nested:!0,subset:"bestPracticals",data:r})},getter:()=>{let r=v(o.value)&&v(o.value).history?v(o.value).history.bestPracticals:null;return r?(r=r.filter(i=>i[51]===t.value[51]),r.length>0?r[0]:null):null},formatter:r=>r[55]}}]:w=[],w}),b=async w=>{if(w||!u.value){const{data:r}=await N.fetchFromHiringApp({fields:[X({type:"interviews",query:`{'10'.EX.'${t.value[3]}'}AND{'20'.XEX.'Canceled'}`})]});g({id:t.value[3],dataset:"history",nested:!0,subset:"interviews",data:r});const i=r.filter(R=>R[20]==="In Progress").sort((R,_)=>R[1].$d>_[1].$d?-1:1);g({id:t.value[3],dataset:"interview",data:i[0]})}console.log(u.value)};return b(),{loading:s,data:u,loadData:b,details:d}}}),za={key:0,class:"q-py-xl"},Ua={class:"row"},Ga={class:"col-9"},Wa={class:"row"};function Ja(a,s,m,v,g,E){const o=H("field-and-label-editable");return n(),p("div",null,[a.loading?(n(),p("div",za,[l(ae,{color:"info",showing:a.loading,"label-class":"text-info",label:"Loading Release..."},null,8,["showing"])])):P("",!0),a.loading?P("",!0):(n(),S(x,{key:1},{default:c(()=>[l(M,{class:"q-pa-sm"},{default:c(()=>[h("div",Ua,[h("div",Ga,[h("div",Wa,[(n(!0),p(L,null,U(a.details,(t,u)=>(n(),p(L,{key:u},[t.hide?P("",!0):(n(),p("div",{key:0,class:j(["col-12 q-pr-sm",t.colClass||"col-md-6"])},[l(o,{item:t},null,8,["item"])],2))],64))),128))])])])]),_:1}),l(ce),l(G,{align:"right"},{default:c(()=>[l(V,{color:"secondary",label:"Back"}),l(V,{color:"info",label:"Continue"})]),_:1})]),_:1}))])}var Ka=z(Ba,[["render",Ja]]);const Za=B({components:{ReleaseStep:ha,ProcessingStep:Da,ProfileStep:ja,InterviewStep:Ka},setup(){const a=ee(),{getEmployee:s}=W(),m=k(()=>s(a.params.id)),v=k(()=>m.value?m.value[584]:0);return{employee:m,step:v}}}),xa={class:"q-pa-none"},et={key:0};function at(a,s,m,v,g,E){const o=H("release-step"),t=H("profile-step"),u=H("interview-step"),d=H("processing-step");return n(),S(Ne,{style:{"max-width":"100vw"}},{default:c(()=>[h("div",xa,[a.employee?(n(),p("div",et,[l(Ae,{flat:"",modelValue:a.step,"onUpdate:modelValue":s[0]||(s[0]=b=>a.step=b),color:"info","active-icon":"build","done-icon":"task_alt","active-color":"accent","done-color":"primary",animated:""},{default:c(()=>[a.step===7?(n(),S(O,{key:0,name:7,prefix:"7",title:"Release"},{default:c(()=>[l(o,{id:a.employee[581]},null,8,["id"])]),_:1})):P("",!0),a.step===0?(n(),S(O,{key:1,name:0,prefix:"-",title:"Not Started"})):P("",!0),l(O,{name:1,prefix:"1",title:a.step===1?"Profile Details":"Profile",done:a.step>1},{default:c(()=>[l(t)]),_:1},8,["title","done"]),l(O,{name:2,prefix:"2",title:"Interview",done:a.step>2},{default:c(()=>[l(u)]),_:1},8,["done"]),l(O,{name:3,prefix:"3",title:"Offer",done:a.step>3},null,8,["done"]),l(O,{name:4,prefix:"4",title:"Processing",done:a.step>4},{default:c(()=>[l(d)]),_:1},8,["done"]),l(O,{name:5,prefix:"5",title:"Deployment",done:a.step>5},null,8,["done"]),l(O,{name:6,prefix:"6",title:"Assignment",done:a.step>6},null,8,["done"])]),_:1},8,["modelValue"])])):P("",!0)])]),_:1})}var Lt=z(Za,[["render",at]]);export{Lt as default};
