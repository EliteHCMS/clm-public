import{q as f,i as y}from"./app.b339b179.js";import{dayjs as i}from"./dayjs.5512aee7.js";import{u as l}from"./useQuerySaver.d29ff9ee.js";const v=async({clm:e},t)=>{const r=!i(e[573]).isValid()||!i(e[573].$d).isSameOrAfter(i().subtract(2,"day"));if(!t&&!r){if(e.workday)return{sync:e.workday,clm:e};{const{data:s}=await f.fetchFromHiringApp({fields:[l({type:"workdaySync",query:"",id:e[578]})]});if(s&&s[22]){const a=u(e);if(a){const{sync:n}=await o({request:a,employee:e});return e[573]=n&&n[1]&&n[1].$d?i(n[1].$d):e[573],{sync:n,clm:e}}else return{sync:null,clm:e}}else if(s&&s.length===0){const a=u(e);if(a){const{sync:n}=await o({request:a,employee:e});return e[573]=n&&n[1]&&n[1].$d?i(n[1].$d):e[573],{sync:n,clm:e}}else return{sync:null,clm:e}}else return{sync:s,clm:e}}}else{const s=u(e);if(s){const{sync:a}=await o({request:s,employee:e});return e[573]=a&&a[1]&&a[1].$d?i(a[1].$d):e[573],{sync:a,clm:e}}else return{sync:null,clm:e}}},u=e=>{let t={sandbox:e[207],includeTransactionLogs:!0,includeRelatedPersons:!0};return e[378]!==""?t.workerId=e[378]:e[188].length===9?t.ssn=e[188]:e[567].length===9?t.sin=e[567]:(e[509],t=null),t},d=async({id:e,worker:t,values:r})=>{const s=r||[{6:{value:e},8:{value:t.workerName||""},9:{value:t.nationalId||""},10:{value:t.userId||""},11:{value:t.workerId||""},12:{value:t.employmentData?JSON.stringify(t.employmentData):""},14:{value:t.personalData?JSON.stringify(t.personalData):""},16:{value:t.workerReference?JSON.stringify(t.workerReference):""},17:{value:t.managementChainData?JSON.stringify(t.managementChainData):""},18:{value:t.organizations?JSON.stringify(t.organizations):""},19:{value:t.applicantReference?JSON.stringify(t.applicantReference):""},21:{value:t.jobHistory?JSON.stringify(t.jobHistory):""},23:{value:t.relatedPersons?JSON.stringify(t.relatedPersons):""}}],{data:a}=await f.upsertRecordsXML({to:"bspfhy84a",data:s,fieldsToReturn:[7],formatObject:7});return a.length>0?{sync:a[0][7]}:a},o=async({request:e,employee:t})=>{const r={employeeRID:t[3],nationalId:t[566],idType:t[565]},s=await y.updateQuickbaseWorkerInterface(r);let a;if(s[0].Status!=="N/A"?a=s[0]:a=null,a)return await d({id:t[3],worker:a});{const n=[{3:{value:t[3]},22:{value:!0}}];return await d({values:n})}};export{v as a,d as s};
